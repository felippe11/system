"""empty message

Revision ID: 0e79ba45ccfe
Revises: 8c2f4a9b1e7d
Create Date: 2026-02-02 15:04:23.978341

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision = '0e79ba45ccfe'
down_revision = '8c2f4a9b1e7d'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('feedback_aberto_dias',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('cliente_id', sa.Integer(), nullable=False),
    sa.Column('data', sa.Date(), nullable=False),
    sa.Column('titulo', sa.String(length=255), nullable=True),
    sa.Column('token', sa.String(length=64), nullable=False),
    sa.Column('ativa', sa.Boolean(), nullable=True),
    sa.Column('exigir_nome', sa.Boolean(), nullable=True),
    sa.Column('exigir_email', sa.Boolean(), nullable=True),
    sa.Column('exigir_telefone', sa.Boolean(), nullable=True),
    sa.Column('exigir_identificador', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['cliente_id'], ['cliente.id'], name=op.f('fk_feedback_aberto_dias_cliente_id_cliente')),
    sa.PrimaryKeyConstraint('id', name=op.f('pk_feedback_aberto_dias')),
    sa.UniqueConstraint('cliente_id', 'data', name='uq_feedback_aberto_cliente_data'),
    sa.UniqueConstraint('token', name=op.f('uq_feedback_aberto_dias_token'))
    )
    op.create_table('feedback_aberto_perguntas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('cliente_id', sa.Integer(), nullable=False),
    sa.Column('titulo', sa.String(length=255), nullable=False),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('tipo', sa.Enum('TEXTO_LIVRE', 'MULTIPLA_ESCOLHA', 'MULTIPLA_ESCOLHA_MULTIPLA', 'ESCALA_NUMERICA', 'SIM_NAO', 'EMAIL', 'TELEFONE', 'DATA', 'NUMERO', name='tipoperguntafeedbackaberto'), nullable=False),
    sa.Column('opcoes', sa.Text(), nullable=True),
    sa.Column('obrigatoria', sa.Boolean(), nullable=True),
    sa.Column('ordem', sa.Integer(), nullable=True),
    sa.Column('ativa', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['cliente_id'], ['cliente.id'], name=op.f('fk_feedback_aberto_perguntas_cliente_id_cliente')),
    sa.PrimaryKeyConstraint('id', name=op.f('pk_feedback_aberto_perguntas'))
    )
    op.create_table('feedback_aberto_dia_perguntas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('dia_id', sa.Integer(), nullable=False),
    sa.Column('pergunta_id', sa.Integer(), nullable=False),
    sa.Column('ordem', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['dia_id'], ['feedback_aberto_dias.id'], name=op.f('fk_feedback_aberto_dia_perguntas_dia_id_feedback_aberto_dias')),
    sa.ForeignKeyConstraint(['pergunta_id'], ['feedback_aberto_perguntas.id'], name=op.f('fk_feedback_aberto_dia_perguntas_pergunta_id_feedback_aberto_perguntas')),
    sa.PrimaryKeyConstraint('id', name=op.f('pk_feedback_aberto_dia_perguntas')),
    sa.UniqueConstraint('dia_id', 'pergunta_id', name='uq_feedback_aberto_dia_pergunta')
    )
    op.create_table('feedback_aberto_envios',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('dia_id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=255), nullable=True),
    sa.Column('email', sa.String(length=255), nullable=True),
    sa.Column('telefone', sa.String(length=64), nullable=True),
    sa.Column('identificador', sa.String(length=120), nullable=True),
    sa.Column('ip_origem', sa.String(length=64), nullable=True),
    sa.Column('user_agent', sa.String(length=255), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['dia_id'], ['feedback_aberto_dias.id'], name=op.f('fk_feedback_aberto_envios_dia_id_feedback_aberto_dias')),
    sa.PrimaryKeyConstraint('id', name=op.f('pk_feedback_aberto_envios'))
    )
    op.create_table('feedback_aberto_respostas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('envio_id', sa.Integer(), nullable=False),
    sa.Column('pergunta_id', sa.Integer(), nullable=False),
    sa.Column('resposta_texto', sa.Text(), nullable=True),
    sa.Column('resposta_numerica', sa.Integer(), nullable=True),
    sa.Column('resposta_escolha', sa.String(length=255), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['envio_id'], ['feedback_aberto_envios.id'], name=op.f('fk_feedback_aberto_respostas_envio_id_feedback_aberto_envios')),
    sa.ForeignKeyConstraint(['pergunta_id'], ['feedback_aberto_perguntas.id'], name=op.f('fk_feedback_aberto_respostas_pergunta_id_feedback_aberto_perguntas')),
    sa.PrimaryKeyConstraint('id', name=op.f('pk_feedback_aberto_respostas'))
    )
    with op.batch_alter_table('maintenance_vehicletire', schema=None) as batch_op:
        batch_op.drop_index('maintenance_vehicletire_tire_id_45446a88')
        batch_op.drop_index('maintenance_vehicletire_vehicle_id_dcea6e7f')
        batch_op.drop_index('unique_active_tire_position', postgresql_where='active')

    op.drop_table('maintenance_vehicletire')
    with op.batch_alter_table('authtoken_token', schema=None) as batch_op:
        batch_op.drop_index('authtoken_token_key_10f0b77e_like')

    op.drop_table('authtoken_token')
    with op.batch_alter_table('fleet_fuelstationlimit', schema=None) as batch_op:
        batch_op.drop_index('fleet_fuelstationlimit_contract_id_94727825')
        batch_op.drop_index('fleet_fuelstationlimit_fuel_station_id_639c2d0f')
        batch_op.drop_index('fleet_fuelstationlimit_municipality_id_21b9fc07')
        batch_op.drop_index('fleet_fuelstationlimit_product_id_8d69fa0a')

    op.drop_table('fleet_fuelstationlimit')
    with op.batch_alter_table('fleet_fuelinvoiceitem', schema=None) as batch_op:
        batch_op.drop_index('fleet_fuelinvoiceitem_invoice_id_da5befd5')
        batch_op.drop_index('fleet_fuelinvoiceitem_matched_fuel_log_id_13a61983')
        batch_op.drop_index('fleet_fuelinvoiceitem_product_id_6203feae')

    op.drop_table('fleet_fuelinvoiceitem')
    with op.batch_alter_table('trips_freetripincident', schema=None) as batch_op:
        batch_op.drop_index('trips_freetripincident_driver_id_1e29f9ff')
        batch_op.drop_index('trips_freetripincident_free_trip_id_8a3e6df6')
        batch_op.drop_index('trips_freetripincident_municipality_id_b6b80ee7')

    op.drop_table('trips_freetripincident')
    with op.batch_alter_table('trips_freetrip', schema=None) as batch_op:
        batch_op.drop_index('trips_freetrip_driver_id_d9e77d1a')
        batch_op.drop_index('trips_freetrip_municipality_id_513d4a18')
        batch_op.drop_index('trips_freetrip_vehicle_id_97ede4f9')

    op.drop_table('trips_freetrip')
    with op.batch_alter_table('maintenance_inventorymovement', schema=None) as batch_op:
        batch_op.drop_index('maintenance_inventorymovement_municipality_id_1d02c3c5')
        batch_op.drop_index('maintenance_inventorymovement_part_id_bf6e09b8')
        batch_op.drop_index('maintenance_inventorymovement_performed_by_id_c99f8c9d')

    op.drop_table('maintenance_inventorymovement')
    with op.batch_alter_table('fleet_vehicle', schema=None) as batch_op:
        batch_op.drop_index('fleet_vehicle_current_contract_id_724e3c10')
        batch_op.drop_index('fleet_vehicle_municipality_id_fad27508')

    op.drop_table('fleet_vehicle')
    with op.batch_alter_table('scheduling_driverworkschedule', schema=None) as batch_op:
        batch_op.drop_index('scheduling_driverworkschedule_driver_id_860d8228')
        batch_op.drop_index('scheduling_driverworkschedule_municipality_id_59f6c70b')

    op.drop_table('scheduling_driverworkschedule')
    with op.batch_alter_table('transport_planning_routestop', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_routestop_municipality_id_d4581051')
        batch_op.drop_index('transport_planning_routestop_route_id_a459b002')

    op.drop_table('transport_planning_routestop')
    with op.batch_alter_table('fleet_fuelinvoice', schema=None) as batch_op:
        batch_op.drop_index('fleet_fuelinvoice_fuel_station_id_4f2cc524')
        batch_op.drop_index('fleet_fuelinvoice_municipality_id_f608ef63')

    op.drop_table('fleet_fuelinvoice')
    with op.batch_alter_table('trips_tripincident', schema=None) as batch_op:
        batch_op.drop_index('trips_tripincident_driver_id_6ede4a8e')
        batch_op.drop_index('trips_tripincident_municipality_id_424dd0f6')
        batch_op.drop_index('trips_tripincident_trip_id_14a24711')

    op.drop_table('trips_tripincident')
    with op.batch_alter_table('forms_formanswer', schema=None) as batch_op:
        batch_op.drop_index('forms_formanswer_question_id_c9035190')
        batch_op.drop_index('forms_formanswer_submission_id_8d21a865')

    op.drop_table('forms_formanswer')
    op.drop_table('trips_tripmanifest')
    with op.batch_alter_table('transport_planning_routeunit', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_routeunit_municipality_id_067f5f58')
        batch_op.drop_index('transport_planning_routeunit_route_id_5cf44840')
        batch_op.drop_index('transport_planning_routeunit_service_unit_id_ec34f217')

    op.drop_table('transport_planning_routeunit')
    with op.batch_alter_table('auth_group_permissions', schema=None) as batch_op:
        batch_op.drop_index('auth_group_permissions_group_id_b120cbf9')
        batch_op.drop_index('auth_group_permissions_permission_id_84c5c92e')

    op.drop_table('auth_group_permissions')
    with op.batch_alter_table('students_classgroup', schema=None) as batch_op:
        batch_op.drop_index('students_classgroup_municipality_id_1d7dfa2c')
        batch_op.drop_index('students_classgroup_school_id_4add0ef4')

    op.drop_table('students_classgroup')
    op.drop_table('django_migrations')
    with op.batch_alter_table('transport_planning_assignment', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_assignment_driver_id_53056ad9')
        batch_op.drop_index('transport_planning_assignment_generated_trip_id_8483c29b')
        batch_op.drop_index('transport_planning_assignment_municipality_id_bea92ba0')
        batch_op.drop_index('transport_planning_assignment_route_id_e4d5a2fa')
        batch_op.drop_index('transport_planning_assignment_vehicle_id_f465ca71')

    op.drop_table('transport_planning_assignment')
    with op.batch_alter_table('api_barber', schema=None) as batch_op:
        batch_op.drop_index('api_barber_shop_id_37fe6f86')

    op.drop_table('api_barber')
    with op.batch_alter_table('trips_monthlyodometer', schema=None) as batch_op:
        batch_op.drop_index('trips_monthlyodometer_vehicle_id_7455852d')

    op.drop_table('trips_monthlyodometer')
    with op.batch_alter_table('auth_group', schema=None) as batch_op:
        batch_op.drop_index('auth_group_name_a6ea08ec_like')

    op.drop_table('auth_group')
    with op.batch_alter_table('transport_planning_route', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_route_contract_id_80f7dc9a')
        batch_op.drop_index('transport_planning_route_municipality_id_e4554fc1')
        batch_op.drop_index('transport_planning_route_transport_service_id_929bf154')

    op.drop_table('transport_planning_route')
    with op.batch_alter_table('tenants_municipality', schema=None) as batch_op:
        batch_op.drop_index('tenants_municipality_cnpj_c536bdef_like')

    op.drop_table('tenants_municipality')
    with op.batch_alter_table('trips_tripexecution', schema=None) as batch_op:
        batch_op.drop_index('trips_tripexecution_driver_id_cee5bec4')
        batch_op.drop_index('trips_tripexecution_municipality_id_93baa027')
        batch_op.drop_index('trips_tripexecution_planned_trip_id_66111665')
        batch_op.drop_index('trips_tripexecution_vehicle_id_82054628')

    op.drop_table('trips_tripexecution')
    with op.batch_alter_table('contracts_contractvehicle', schema=None) as batch_op:
        batch_op.drop_index('contracts_contractvehicle_contract_id_3d0b0062')
        batch_op.drop_index('contracts_contractvehicle_municipality_id_7db91e2a')
        batch_op.drop_index('contracts_contractvehicle_vehicle_id_5f48200c')

    op.drop_table('contracts_contractvehicle')
    with op.batch_alter_table('trips_tripexecutionstop', schema=None) as batch_op:
        batch_op.drop_index('trips_tripexecutionstop_destination_id_dea7dbfd')
        batch_op.drop_index('trips_tripexecutionstop_trip_execution_id_0d944283')

    op.drop_table('trips_tripexecutionstop')
    with op.batch_alter_table('fleet_fuellog', schema=None) as batch_op:
        batch_op.drop_index('fleet_fuellog_driver_id_2f64594a')
        batch_op.drop_index('fleet_fuellog_fuel_station_ref_id_eb6b5d5c')
        batch_op.drop_index('fleet_fuellog_municipality_id_8160a726')
        batch_op.drop_index('fleet_fuellog_product_id_e0b968dd')
        batch_op.drop_index('fleet_fuellog_service_order_id_95110efa')
        batch_op.drop_index('fleet_fuellog_trip_id_9c044440')
        batch_op.drop_index('fleet_fuellog_vehicle_id_84aa6c18')

    op.drop_table('fleet_fuellog')
    with op.batch_alter_table('fleet_vehicleinspection', schema=None) as batch_op:
        batch_op.drop_index('fleet_vehicleinspection_driver_id_6f9c4ac4')
        batch_op.drop_index('fleet_vehicleinspection_municipality_id_96c94757')
        batch_op.drop_index('fleet_vehicleinspection_vehicle_id_10f7131c')

    op.drop_table('fleet_vehicleinspection')
    op.drop_table('django_content_type')
    with op.batch_alter_table('maintenance_tire', schema=None) as batch_op:
        batch_op.drop_index('maintenance_tire_municipality_id_2e74023e')

    op.drop_table('maintenance_tire')
    with op.batch_alter_table('transport_planning_serviceunit', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_serviceunit_municipality_id_1cf87409')

    op.drop_table('transport_planning_serviceunit')
    with op.batch_alter_table('auth_permission', schema=None) as batch_op:
        batch_op.drop_index('auth_permission_content_type_id_2f476e4b')

    op.drop_table('auth_permission')
    with op.batch_alter_table('notifications_notificationdevice', schema=None) as batch_op:
        batch_op.drop_index('notifications_notificationdevice_driver_id_dbfde0d3')
        batch_op.drop_index('notifications_notificationdevice_municipality_id_28bc45c7')
        batch_op.drop_index('notifications_notificationdevice_user_id_8200c980')

    op.drop_table('notifications_notificationdevice')
    with op.batch_alter_table('django_admin_log', schema=None) as batch_op:
        batch_op.drop_index('django_admin_log_content_type_id_c4bce8eb')
        batch_op.drop_index('django_admin_log_user_id_c564eba6')

    op.drop_table('django_admin_log')
    with op.batch_alter_table('django_session', schema=None) as batch_op:
        batch_op.drop_index('django_session_expire_date_a5c62663')
        batch_op.drop_index('django_session_session_key_c0390e0f_like')

    op.drop_table('django_session')
    with op.batch_alter_table('trips_plannedtripstop', schema=None) as batch_op:
        batch_op.drop_index('trips_plannedtripstop_destination_id_0770bfee')
        batch_op.drop_index('trips_plannedtripstop_planned_trip_id_ad17346d')

    op.drop_table('trips_plannedtripstop')
    with op.batch_alter_table('trips_tripmanifestpassenger', schema=None) as batch_op:
        batch_op.drop_index('trips_tripmanifestpassenger_companion_id_b032bdf6')
        batch_op.drop_index('trips_tripmanifestpassenger_linked_patient_id_b7cb9dbe')
        batch_op.drop_index('trips_tripmanifestpassenger_manifest_id_2d8dc761')
        batch_op.drop_index('trips_tripmanifestpassenger_patient_id_d2f7f3a4')
        batch_op.drop_index('trips_tripmanifestpassenger_student_id_787ee508')

    op.drop_table('trips_tripmanifestpassenger')
    with op.batch_alter_table('api_user_user_permissions', schema=None) as batch_op:
        batch_op.drop_index('api_user_user_permissions_permission_id_305b7fea')
        batch_op.drop_index('api_user_user_permissions_user_id_f3945d65')

    op.drop_table('api_user_user_permissions')
    with op.batch_alter_table('transport_planning_route_preferred_drivers', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_route_preferred_drivers_driver_id_e5894036')
        batch_op.drop_index('transport_planning_route_preferred_drivers_route_id_f1039491')

    op.drop_table('transport_planning_route_preferred_drivers')
    with op.batch_alter_table('trips_plannedtrippassenger', schema=None) as batch_op:
        batch_op.drop_index('trips_plannedtrippassenger_companion_id_71ebcc5e')
        batch_op.drop_index('trips_plannedtrippassenger_patient_id_caecc0a3')
        batch_op.drop_index('trips_plannedtrippassenger_planned_trip_id_0697e9fb')
        batch_op.drop_index('trips_plannedtrippassenger_student_id_2d900fe2')

    op.drop_table('trips_plannedtrippassenger')
    with op.batch_alter_table('students_school', schema=None) as batch_op:
        batch_op.drop_index('students_school_destination_id_28ccc2c8')
        batch_op.drop_index('students_school_municipality_id_4ad0e800')

    op.drop_table('students_school')
    with op.batch_alter_table('contracts_contract', schema=None) as batch_op:
        batch_op.drop_index('contracts_contract_municipality_id_9b4d54f6')

    op.drop_table('contracts_contract')
    with op.batch_alter_table('trips_tripgpsping', schema=None) as batch_op:
        batch_op.drop_index('trips_tripg_driver__b455e8_idx')
        batch_op.drop_index('trips_tripg_trip_id_86e071_idx')
        batch_op.drop_index('trips_tripgpsping_driver_id_a070f02f')
        batch_op.drop_index('trips_tripgpsping_trip_id_8c66e2f2')

    op.drop_table('trips_tripgpsping')
    with op.batch_alter_table('token_blacklist_outstandingtoken', schema=None) as batch_op:
        batch_op.drop_index('token_blacklist_outstandingtoken_jti_hex_d9bdf6f7_like')
        batch_op.drop_index('token_blacklist_outstandingtoken_user_id_83bc629a')

    op.drop_table('token_blacklist_outstandingtoken')
    with op.batch_alter_table('transport_planning_transportservice', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_transportservice_form_template_id_bef029c3')
        batch_op.drop_index('transport_planning_transportservice_municipality_id_9b0cc15b')

    op.drop_table('transport_planning_transportservice')
    with op.batch_alter_table('fleet_fuelrule', schema=None) as batch_op:
        batch_op.drop_index('fleet_fuelrule_contract_id_d23fa8b1')
        batch_op.drop_index('fleet_fuelrule_municipality_id_e5445180')
        batch_op.drop_index('fleet_fuelrule_vehicle_id_a8fdec16')

    op.drop_table('fleet_fuelrule')
    with op.batch_alter_table('fleet_fuelalert', schema=None) as batch_op:
        batch_op.drop_index('fleet_fuelalert_fuel_log_id_e9ef30f0')
        batch_op.drop_index('fleet_fuelalert_municipality_id_fdabf918')
        batch_op.drop_index('fleet_fuelalert_service_order_id_d6c7ff79')
        batch_op.drop_index('fleet_fuelalert_trip_id_c4971bbd')

    op.drop_table('fleet_fuelalert')
    with op.batch_alter_table('accounts_user_groups', schema=None) as batch_op:
        batch_op.drop_index('accounts_user_groups_group_id_bd11a704')
        batch_op.drop_index('accounts_user_groups_user_id_52b62117')

    op.drop_table('accounts_user_groups')
    with op.batch_alter_table('scheduling_driveravailabilityblock', schema=None) as batch_op:
        batch_op.drop_index('scheduling_driveravailabilityblock_created_by_id_a96742f7')
        batch_op.drop_index('scheduling_driveravailabilityblock_driver_id_7be7f625')
        batch_op.drop_index('scheduling_driveravailabilityblock_municipality_id_3d1360fa')

    op.drop_table('scheduling_driveravailabilityblock')
    with op.batch_alter_table('fleet_vehiclemaintenance', schema=None) as batch_op:
        batch_op.drop_index('fleet_vehiclemaintenance_vehicle_id_dfc8c124')

    op.drop_table('fleet_vehiclemaintenance')
    with op.batch_alter_table('fleet_fuelstation', schema=None) as batch_op:
        batch_op.drop_index('fleet_fuelstation_municipality_id_22248af7')

    op.drop_table('fleet_fuelstation')
    with op.batch_alter_table('health_companion', schema=None) as batch_op:
        batch_op.drop_index('health_companion_municipality_id_cb2f7eb4')
        batch_op.drop_index('health_companion_patient_id_4e85a514')

    op.drop_table('health_companion')
    with op.batch_alter_table('api_user_groups', schema=None) as batch_op:
        batch_op.drop_index('api_user_groups_group_id_3af85785')
        batch_op.drop_index('api_user_groups_user_id_a5ff39fa')

    op.drop_table('api_user_groups')
    with op.batch_alter_table('accounts_user_user_permissions', schema=None) as batch_op:
        batch_op.drop_index('accounts_user_user_permissions_permission_id_113bb443')
        batch_op.drop_index('accounts_user_user_permissions_user_id_e4f0a161')

    op.drop_table('accounts_user_user_permissions')
    op.drop_table('token_blacklist_blacklistedtoken')
    with op.batch_alter_table('students_studentcard', schema=None) as batch_op:
        batch_op.drop_index('students_studentcard_municipality_id_fb3ec95b')
        batch_op.drop_index('students_studentcard_student_id_c403dba2')
        batch_op.drop_index('unique_active_card_per_student_type', postgresql_where="((status)::text = 'ACTIVE'::text)")

    op.drop_table('students_studentcard')
    with op.batch_alter_table('api_review', schema=None) as batch_op:
        batch_op.drop_index('api_review_shop_id_5b5f7c0d')
        batch_op.drop_index('api_review_user_id_8bf97ad4')

    op.drop_table('api_review')
    with op.batch_alter_table('transport_planning_serviceapplication', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_service_form_submission_id_711d1aa2')
        batch_op.drop_index('transport_planning_service_transport_service_id_d72d389f')
        batch_op.drop_index('transport_planning_serviceapplication_municipality_id_be2b317d')
        batch_op.drop_index('transport_planning_serviceapplication_person_id_50d73a3f')
        batch_op.drop_index('transport_planning_serviceapplication_route_id_74fb2489')

    op.drop_table('transport_planning_serviceapplication')
    with op.batch_alter_table('students_studenttransportregistration', schema=None) as batch_op:
        batch_op.drop_index('students_studenttransportr_allowed_contract_id_c82671eb')
        batch_op.drop_index('students_studenttransportregistration_municipality_id_8a654005')
        batch_op.drop_index('students_studenttransportregistration_school_id_5530c39a')
        batch_op.drop_index('students_studenttransportregistration_student_id_fb549e97')

    op.drop_table('students_studenttransportregistration')
    with op.batch_alter_table('fleet_vehicleinspectiondamagephoto', schema=None) as batch_op:
        batch_op.drop_index('fleet_vehicleinspectiondamagephoto_inspection_id_5686bfbd')

    op.drop_table('fleet_vehicleinspectiondamagephoto')
    with op.batch_alter_table('api_booking_services', schema=None) as batch_op:
        batch_op.drop_index('api_booking_services_booking_id_c24b0228')
        batch_op.drop_index('api_booking_services_service_id_0a3379d9')

    op.drop_table('api_booking_services')
    with op.batch_alter_table('api_booking', schema=None) as batch_op:
        batch_op.drop_index('api_booking_barber_id_926556d3')
        batch_op.drop_index('api_booking_shop_id_deb36517')
        batch_op.drop_index('api_booking_user_id_0beb30da')

    op.drop_table('api_booking')
    op.drop_table('drivers_drivergeofence')
    op.drop_table('api_barbershop')
    with op.batch_alter_table('contracts_rentalperiod', schema=None) as batch_op:
        batch_op.drop_index('contracts_rentalperiod_contract_id_bae27a50')
        batch_op.drop_index('contracts_rentalperiod_municipality_id_f3e7b793')
        batch_op.drop_index('contracts_rentalperiod_vehicle_id_90e53068')

    op.drop_table('contracts_rentalperiod')
    with op.batch_alter_table('api_user', schema=None) as batch_op:
        batch_op.drop_index('api_user_username_cf4e88d2_like')

    op.drop_table('api_user')
    with op.batch_alter_table('fleet_fuelproduct', schema=None) as batch_op:
        batch_op.drop_index('fleet_fuelproduct_municipality_id_e6c41409')

    op.drop_table('fleet_fuelproduct')
    with op.batch_alter_table('forms_formsubmission', schema=None) as batch_op:
        batch_op.drop_index('forms_formsubmission_cpf_0d02008e')
        batch_op.drop_index('forms_formsubmission_cpf_0d02008e_like')
        batch_op.drop_index('forms_formsubmission_form_template_id_0c99c680')
        batch_op.drop_index('forms_formsubmission_linked_student_card_id_474580b0')
        batch_op.drop_index('forms_formsubmission_linked_student_id_76ff7cb7')
        batch_op.drop_index('forms_formsubmission_linked_trip_id_a934f985')
        batch_op.drop_index('forms_formsubmission_municipality_id_b2e47e99')
        batch_op.drop_index('forms_formsubmission_protocol_number_b9e1efb3_like')

    op.drop_table('forms_formsubmission')
    with op.batch_alter_table('students_student', schema=None) as batch_op:
        batch_op.drop_index('students_student_class_group_id_39273d50')
        batch_op.drop_index('students_student_cpf_55107b60')
        batch_op.drop_index('students_student_cpf_55107b60_like')
        batch_op.drop_index('students_student_municipality_id_cd84d4b2')
        batch_op.drop_index('students_student_school_id_be4a7ab9')
        batch_op.drop_index(
            'unique_active_student_cpf_per_municipality',
            postgresql_where="((status)::text = 'ACTIVE'::text)",
        )

    op.drop_table('students_student')
    with op.batch_alter_table('drivers_driver', schema=None) as batch_op:
        batch_op.drop_index('drivers_driver_access_code_7a45c17a_like')
        batch_op.drop_index('drivers_driver_municipality_id_3065c6d4')

    op.drop_table('drivers_driver')
    with op.batch_alter_table('forms_formoption', schema=None) as batch_op:
        batch_op.drop_index('forms_formoption_question_id_e3597f36')

    op.drop_table('forms_formoption')
    with op.batch_alter_table('notifications_notification', schema=None) as batch_op:
        batch_op.drop_index('notifications_notification_municipality_id_31b4dd52')
        batch_op.drop_index('notifications_notification_recipient_driver_id_088dcc20')
        batch_op.drop_index('notifications_notification_recipient_user_id_0323d78e')

    op.drop_table('notifications_notification')
    with op.batch_alter_table('forms_formquestion', schema=None) as batch_op:
        batch_op.drop_index('forms_formquestion_field_name_6770e0b4')
        batch_op.drop_index('forms_formquestion_field_name_6770e0b4_like')
        batch_op.drop_index('forms_formquestion_form_template_id_64bca84a')

    op.drop_table('forms_formquestion')
    with op.batch_alter_table('transport_planning_eligibilitypolicy', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_eligibi_transport_service_id_3ff93548')
        batch_op.drop_index('transport_planning_eligibilitypolicy_municipality_id_d987a50d')
        batch_op.drop_index('transport_planning_eligibilitypolicy_route_id_2c22cb0e')

    op.drop_table('transport_planning_eligibilitypolicy')
    with op.batch_alter_table('maintenance_serviceorderitem', schema=None) as batch_op:
        batch_op.drop_index('maintenance_serviceorderitem_part_id_4e391b7b')
        batch_op.drop_index('maintenance_serviceorderitem_service_order_id_63118b6f')

    op.drop_table('maintenance_serviceorderitem')
    with op.batch_alter_table('maintenance_inventorypart', schema=None) as batch_op:
        batch_op.drop_index('maintenance_inventorypart_municipality_id_a6922598')

    op.drop_table('maintenance_inventorypart')
    with op.batch_alter_table('trips_serviceorder', schema=None) as batch_op:
        batch_op.drop_index('trips_serviceorder_driver_id_6668c0b0')
        batch_op.drop_index('trips_serviceorder_municipality_id_0d50d4c8')
        batch_op.drop_index('trips_serviceorder_vehicle_id_4cfc280d')

    op.drop_table('trips_serviceorder')
    with op.batch_alter_table('transport_planning_person', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_person_cpf_1f1d4cf3')
        batch_op.drop_index('transport_planning_person_cpf_1f1d4cf3_like')
        batch_op.drop_index('transport_planning_person_municipality_id_a4c9e2ec')
        batch_op.drop_index('unique_active_person_per_municipality', postgresql_where="((status)::text = 'ACTIVE'::text)")

    op.drop_table('transport_planning_person')
    with op.batch_alter_table('forms_formtemplate', schema=None) as batch_op:
        batch_op.drop_index('forms_formtemplate_municipality_id_a1dc5c31')
        batch_op.drop_index('forms_formtemplate_slug_77fa9aff_like')

    op.drop_table('forms_formtemplate')
    with op.batch_alter_table('api_service', schema=None) as batch_op:
        batch_op.drop_index('api_service_shop_id_0b480f74')

    op.drop_table('api_service')
    with op.batch_alter_table('maintenance_serviceorderlabor', schema=None) as batch_op:
        batch_op.drop_index('maintenance_serviceorderlabor_service_order_id_1bc8c3df')

    op.drop_table('maintenance_serviceorderlabor')
    with op.batch_alter_table('trips_trip', schema=None) as batch_op:
        batch_op.drop_index('trips_trip_contract_id_a23f419c')
        batch_op.drop_index('trips_trip_driver_id_26500acf')
        batch_op.drop_index('trips_trip_municipality_id_047872f9')
        batch_op.drop_index('trips_trip_rental_period_id_f9f870f0')
        batch_op.drop_index('trips_trip_service_order_id_503bebd6')
        batch_op.drop_index('trips_trip_vehicle_id_e21456ae')

    op.drop_table('trips_trip')
    with op.batch_alter_table('accounts_user', schema=None) as batch_op:
        batch_op.drop_index('accounts_user_active_municipality_id_005e5639')
        batch_op.drop_index('accounts_user_email_b2644a56_like')
        batch_op.drop_index('accounts_user_municipality_id_96d46f3e')

    op.drop_table('accounts_user')
    with op.batch_alter_table('trips_plannedtrip', schema=None) as batch_op:
        batch_op.drop_index('trips_plannedtrip_driver_id_0170d2b4')
        batch_op.drop_index('trips_plannedtrip_municipality_id_4ae054f1')
        batch_op.drop_index('trips_plannedtrip_vehicle_id_34a21339')

    op.drop_table('trips_plannedtrip')
    with op.batch_alter_table('transport_planning_route_preferred_vehicles', schema=None) as batch_op:
        batch_op.drop_index('transport_planning_route_preferred_vehicles_route_id_a7f09921')
        batch_op.drop_index('transport_planning_route_preferred_vehicles_vehicle_id_60ac142f')

    op.drop_table('transport_planning_route_preferred_vehicles')
    with op.batch_alter_table('destinations_destination', schema=None) as batch_op:
        batch_op.drop_index('destinations_destination_municipality_id_6c1e0385')

    op.drop_table('destinations_destination')
    with op.batch_alter_table('maintenance_serviceorder', schema=None) as batch_op:
        batch_op.drop_index('maintenance_serviceorder_assigned_to_id_dd9d23a6')
        batch_op.drop_index('maintenance_serviceorder_municipality_id_eac45036')
        batch_op.drop_index('maintenance_serviceorder_opened_by_id_5d8e8f9f')
        batch_op.drop_index('maintenance_serviceorder_vehicle_id_03e18897')

    op.drop_table('maintenance_serviceorder')
    with op.batch_alter_table('maintenance_maintenanceplan', schema=None) as batch_op:
        batch_op.drop_index('maintenance_maintenanceplan_municipality_id_a90c3bda')
        batch_op.drop_index('maintenance_maintenanceplan_vehicle_id_085adfd4')

    op.drop_table('maintenance_maintenanceplan')
    with op.batch_alter_table('health_patient', schema=None) as batch_op:
        batch_op.drop_index('health_patient_cpf_4424fbda')
        batch_op.drop_index('health_patient_cpf_4424fbda_like')
        batch_op.drop_index('health_patient_municipality_id_3878cee3')

    op.drop_table('health_patient')
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('health_patient',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('full_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('cpf', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('date_of_birth', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('comorbidities', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('needs_companion', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='health_patient_municipality_id_3878cee3_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='health_patient_pkey'),
    sa.UniqueConstraint('municipality_id', 'cpf', name='health_patient_municipality_id_cpf_8639dc7a_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('health_patient', schema=None) as batch_op:
        batch_op.create_index('health_patient_municipality_id_3878cee3', ['municipality_id'], unique=False)
        batch_op.create_index('health_patient_cpf_4424fbda_like', ['cpf'], unique=False)
        batch_op.create_index('health_patient_cpf_4424fbda', ['cpf'], unique=False)

    op.create_table('maintenance_maintenanceplan',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('trigger_type', sa.VARCHAR(length=8), autoincrement=False, nullable=False),
    sa.Column('interval_km', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('interval_days', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('last_service_odometer', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('last_service_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('is_active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.CheckConstraint('interval_days >= 0', name='maintenance_maintenanceplan_interval_days_check'),
    sa.CheckConstraint('interval_km >= 0', name='maintenance_maintenanceplan_interval_km_check'),
    sa.CheckConstraint('last_service_odometer >= 0', name='maintenance_maintenanceplan_last_service_odometer_check'),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='maintenance_maintena_municipality_id_a90c3bda_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='maintenance_maintena_vehicle_id_085adfd4_fk_fleet_veh', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='maintenance_maintenanceplan_pkey')
    )
    with op.batch_alter_table('maintenance_maintenanceplan', schema=None) as batch_op:
        batch_op.create_index('maintenance_maintenanceplan_vehicle_id_085adfd4', ['vehicle_id'], unique=False)
        batch_op.create_index('maintenance_maintenanceplan_municipality_id_a90c3bda', ['municipality_id'], unique=False)

    op.create_table('maintenance_serviceorder',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('provider_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('priority', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('opened_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('started_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('completed_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('vehicle_odometer_open', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('vehicle_odometer_close', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('total_cost', sa.NUMERIC(precision=14, scale=2), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('assigned_to_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('opened_by_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('vehicle_odometer_close >= 0', name='maintenance_serviceorder_vehicle_odometer_close_check'),
    sa.CheckConstraint('vehicle_odometer_open >= 0', name='maintenance_serviceorder_vehicle_odometer_open_check'),
    sa.ForeignKeyConstraint(['assigned_to_id'], ['accounts_user.id'], name='maintenance_serviceo_assigned_to_id_dd9d23a6_fk_accounts_', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='maintenance_serviceo_municipality_id_eac45036_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['opened_by_id'], ['accounts_user.id'], name='maintenance_serviceo_opened_by_id_5d8e8f9f_fk_accounts_', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='maintenance_serviceo_vehicle_id_03e18897_fk_fleet_veh', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='maintenance_serviceorder_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('maintenance_serviceorder', schema=None) as batch_op:
        batch_op.create_index('maintenance_serviceorder_vehicle_id_03e18897', ['vehicle_id'], unique=False)
        batch_op.create_index('maintenance_serviceorder_opened_by_id_5d8e8f9f', ['opened_by_id'], unique=False)
        batch_op.create_index('maintenance_serviceorder_municipality_id_eac45036', ['municipality_id'], unique=False)
        batch_op.create_index('maintenance_serviceorder_assigned_to_id_dd9d23a6', ['assigned_to_id'], unique=False)

    op.create_table('destinations_destination',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('type', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('number', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('district', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('city', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('state', sa.VARCHAR(length=2), autoincrement=False, nullable=False),
    sa.Column('postal_code', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('latitude', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=False),
    sa.Column('longitude', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='destinations_destina_municipality_id_6c1e0385_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='destinations_destination_pkey'),
    sa.UniqueConstraint('municipality_id', 'name', name='destinations_destination_municipality_id_name_39ee5be5_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('destinations_destination', schema=None) as batch_op:
        batch_op.create_index('destinations_destination_municipality_id_6c1e0385', ['municipality_id'], unique=False)

    op.create_table('transport_planning_route_preferred_vehicles',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('route_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['route_id'], ['transport_planning_route.id'], name='transport_planning_r_route_id_a7f09921_fk_transport', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='transport_planning_r_vehicle_id_60ac142f_fk_fleet_veh', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_route_preferred_vehicles_pkey'),
    sa.UniqueConstraint('route_id', 'vehicle_id', name='transport_planning_route_route_id_vehicle_id_4e57f554_uniq')
    )
    with op.batch_alter_table('transport_planning_route_preferred_vehicles', schema=None) as batch_op:
        batch_op.create_index('transport_planning_route_preferred_vehicles_vehicle_id_60ac142f', ['vehicle_id'], unique=False)
        batch_op.create_index('transport_planning_route_preferred_vehicles_route_id_a7f09921', ['route_id'], unique=False)

    op.create_table('trips_plannedtrip',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('module', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('recurrence', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('start_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('end_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('departure_time', postgresql.TIME(), autoincrement=False, nullable=False),
    sa.Column('return_time_expected', postgresql.TIME(), autoincrement=False, nullable=False),
    sa.Column('planned_capacity', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('optimize_route', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.CheckConstraint('planned_capacity >= 0', name='trips_plannedtrip_planned_capacity_check'),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='trips_plannedtrip_driver_id_0170d2b4_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='trips_plannedtrip_municipality_id_4ae054f1_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='trips_plannedtrip_vehicle_id_34a21339_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_plannedtrip_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('trips_plannedtrip', schema=None) as batch_op:
        batch_op.create_index('trips_plannedtrip_vehicle_id_34a21339', ['vehicle_id'], unique=False)
        batch_op.create_index('trips_plannedtrip_municipality_id_4ae054f1', ['municipality_id'], unique=False)
        batch_op.create_index('trips_plannedtrip_driver_id_0170d2b4', ['driver_id'], unique=False)

    op.create_table('accounts_user',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('password', sa.VARCHAR(length=128), autoincrement=False, nullable=False),
    sa.Column('last_login', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('is_superuser', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('username', sa.VARCHAR(length=150), autoincrement=False, nullable=True),
    sa.Column('first_name', sa.VARCHAR(length=150), autoincrement=False, nullable=False),
    sa.Column('last_name', sa.VARCHAR(length=150), autoincrement=False, nullable=False),
    sa.Column('email', sa.VARCHAR(length=254), autoincrement=False, nullable=False),
    sa.Column('is_staff', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('is_active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('date_joined', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('role', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('active_municipality_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['active_municipality_id'], ['tenants_municipality.id'], name='accounts_user_active_municipality__005e5639_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='accounts_user_municipality_id_96d46f3e_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='accounts_user_pkey'),
    sa.UniqueConstraint('email', name='accounts_user_email_key'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('accounts_user', schema=None) as batch_op:
        batch_op.create_index('accounts_user_municipality_id_96d46f3e', ['municipality_id'], unique=False)
        batch_op.create_index('accounts_user_email_b2644a56_like', ['email'], unique=False)
        batch_op.create_index('accounts_user_active_municipality_id_005e5639', ['active_municipality_id'], unique=False)

    op.create_table('trips_trip',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('origin', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('destination', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('departure_datetime', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('return_datetime_expected', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('return_datetime_actual', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('odometer_start', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('odometer_end', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('passengers_count', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('stops_description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('passengers_details', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('cargo_description', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('cargo_purpose', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('cargo_quantity', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('cargo_size', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('category', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('contract_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('rental_period_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('service_order_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.CheckConstraint('cargo_quantity >= 0', name='trips_trip_cargo_quantity_check'),
    sa.CheckConstraint('odometer_end >= 0', name='trips_trip_odometer_end_check'),
    sa.CheckConstraint('odometer_start >= 0', name='trips_trip_odometer_start_check'),
    sa.CheckConstraint('passengers_count >= 0', name='trips_trip_passengers_count_check'),
    sa.ForeignKeyConstraint(['contract_id'], ['contracts_contract.id'], name='trips_trip_contract_id_a23f419c_fk_contracts_contract_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='trips_trip_driver_id_26500acf_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='trips_trip_municipality_id_047872f9_fk_tenants_municipality_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['rental_period_id'], ['contracts_rentalperiod.id'], name='trips_trip_rental_period_id_f9f870f0_fk_contracts', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['service_order_id'], ['trips_serviceorder.id'], name='trips_trip_service_order_id_503bebd6_fk_trips_serviceorder_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='trips_trip_vehicle_id_e21456ae_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_trip_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('trips_trip', schema=None) as batch_op:
        batch_op.create_index('trips_trip_vehicle_id_e21456ae', ['vehicle_id'], unique=False)
        batch_op.create_index('trips_trip_service_order_id_503bebd6', ['service_order_id'], unique=False)
        batch_op.create_index('trips_trip_rental_period_id_f9f870f0', ['rental_period_id'], unique=False)
        batch_op.create_index('trips_trip_municipality_id_047872f9', ['municipality_id'], unique=False)
        batch_op.create_index('trips_trip_driver_id_26500acf', ['driver_id'], unique=False)
        batch_op.create_index('trips_trip_contract_id_a23f419c', ['contract_id'], unique=False)

    op.create_table('maintenance_serviceorderlabor',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('description', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('hours', sa.NUMERIC(precision=8, scale=2), autoincrement=False, nullable=False),
    sa.Column('hourly_rate', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('total_cost', sa.NUMERIC(precision=14, scale=2), autoincrement=False, nullable=False),
    sa.Column('service_order_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['service_order_id'], ['maintenance_serviceorder.id'], name='maintenance_serviceo_service_order_id_1bc8c3df_fk_maintenan', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='maintenance_serviceorderlabor_pkey')
    )
    with op.batch_alter_table('maintenance_serviceorderlabor', schema=None) as batch_op:
        batch_op.create_index('maintenance_serviceorderlabor_service_order_id_1bc8c3df', ['service_order_id'], unique=False)

    op.create_table('api_service',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('price', sa.NUMERIC(precision=6, scale=2), autoincrement=False, nullable=False),
    sa.Column('duration_min', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('category', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('discount', sa.NUMERIC(precision=6, scale=2), autoincrement=False, nullable=True),
    sa.Column('shop_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['shop_id'], ['api_barbershop.id'], name='api_service_shop_id_0b480f74_fk_api_barbershop_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='api_service_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('api_service', schema=None) as batch_op:
        batch_op.create_index('api_service_shop_id_0b480f74', ['shop_id'], unique=False)

    op.create_table('forms_formtemplate',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('slug', sa.VARCHAR(length=64), autoincrement=False, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('is_active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('require_cpf', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('form_type', sa.VARCHAR(length=64), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='forms_formtemplate_municipality_id_a1dc5c31_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='forms_formtemplate_pkey'),
    sa.UniqueConstraint('slug', name='forms_formtemplate_slug_key'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('forms_formtemplate', schema=None) as batch_op:
        batch_op.create_index('forms_formtemplate_slug_77fa9aff_like', ['slug'], unique=False)
        batch_op.create_index('forms_formtemplate_municipality_id_a1dc5c31', ['municipality_id'], unique=False)

    op.create_table('transport_planning_person',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('full_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('cpf', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('date_of_birth', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('phone', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('district', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('location_lat', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=True),
    sa.Column('location_lng', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=True),
    sa.Column('categories', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_p_municipality_id_a4c9e2ec_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_person_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('transport_planning_person', schema=None) as batch_op:
        batch_op.create_index('unique_active_person_per_municipality', ['municipality_id', 'cpf'], unique=True, postgresql_where="((status)::text = 'ACTIVE'::text)")
        batch_op.create_index('transport_planning_person_municipality_id_a4c9e2ec', ['municipality_id'], unique=False)
        batch_op.create_index('transport_planning_person_cpf_1f1d4cf3_like', ['cpf'], unique=False)
        batch_op.create_index('transport_planning_person_cpf_1f1d4cf3', ['cpf'], unique=False)

    op.create_table('trips_serviceorder',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('external_id', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('service_type', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('planned_start', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('planned_end', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('executed_start', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('executed_end', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('raw_payload', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='trips_serviceorder_driver_id_6668c0b0_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='trips_serviceorder_municipality_id_0d50d4c8_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='trips_serviceorder_vehicle_id_4cfc280d_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_serviceorder_pkey'),
    sa.UniqueConstraint('municipality_id', 'external_id', name='unique_service_order_external_id'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('trips_serviceorder', schema=None) as batch_op:
        batch_op.create_index('trips_serviceorder_vehicle_id_4cfc280d', ['vehicle_id'], unique=False)
        batch_op.create_index('trips_serviceorder_municipality_id_0d50d4c8', ['municipality_id'], unique=False)
        batch_op.create_index('trips_serviceorder_driver_id_6668c0b0', ['driver_id'], unique=False)

    op.create_table('maintenance_serviceorderitem',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('quantity', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('unit_cost', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('total_cost', sa.NUMERIC(precision=14, scale=2), autoincrement=False, nullable=False),
    sa.Column('part_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('service_order_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['part_id'], ['maintenance_inventorypart.id'], name='maintenance_serviceo_part_id_4e391b7b_fk_maintenan', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['service_order_id'], ['maintenance_serviceorder.id'], name='maintenance_serviceo_service_order_id_63118b6f_fk_maintenan', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='maintenance_serviceorderitem_pkey')
    )
    with op.batch_alter_table('maintenance_serviceorderitem', schema=None) as batch_op:
        batch_op.create_index('maintenance_serviceorderitem_service_order_id_63118b6f', ['service_order_id'], unique=False)
        batch_op.create_index('maintenance_serviceorderitem_part_id_4e391b7b', ['part_id'], unique=False)

    op.create_table('transport_planning_eligibilitypolicy',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('rules_json', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('decision_mode', sa.VARCHAR(length=30), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('route_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('transport_service_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_e_municipality_id_d987a50d_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['route_id'], ['transport_planning_route.id'], name='transport_planning_e_route_id_2c22cb0e_fk_transport', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['transport_service_id'], ['transport_planning_transportservice.id'], name='transport_planning_e_transport_service_id_3ff93548_fk_transport', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_eligibilitypolicy_pkey')
    )
    with op.batch_alter_table('transport_planning_eligibilitypolicy', schema=None) as batch_op:
        batch_op.create_index('transport_planning_eligibilitypolicy_route_id_2c22cb0e', ['route_id'], unique=False)
        batch_op.create_index('transport_planning_eligibilitypolicy_municipality_id_d987a50d', ['municipality_id'], unique=False)
        batch_op.create_index('transport_planning_eligibi_transport_service_id_3ff93548', ['transport_service_id'], unique=False)

    op.create_table('forms_formquestion',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('order', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('label', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('help_text', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('field_name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('type', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('required', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('config', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('form_template_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('"order" >= 0', name='forms_formquestion_order_check'),
    sa.ForeignKeyConstraint(['form_template_id'], ['forms_formtemplate.id'], name='forms_formquestion_form_template_id_64bca84a_fk_forms_for', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='forms_formquestion_pkey'),
    sa.UniqueConstraint('form_template_id', 'field_name', name='forms_formquestion_form_template_id_field_name_5906a17e_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('forms_formquestion', schema=None) as batch_op:
        batch_op.create_index('forms_formquestion_form_template_id_64bca84a', ['form_template_id'], unique=False)
        batch_op.create_index('forms_formquestion_field_name_6770e0b4_like', ['field_name'], unique=False)
        batch_op.create_index('forms_formquestion_field_name_6770e0b4', ['field_name'], unique=False)

    op.create_table('notifications_notification',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('channel', sa.VARCHAR(length=12), autoincrement=False, nullable=False),
    sa.Column('event_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('message', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('metadata', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('is_read', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('sent_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('delivery_error', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('recipient_driver_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('recipient_user_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='notifications_notifi_municipality_id_31b4dd52_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['recipient_driver_id'], ['drivers_driver.id'], name='notifications_notifi_recipient_driver_id_088dcc20_fk_drivers_d', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['recipient_user_id'], ['accounts_user.id'], name='notifications_notifi_recipient_user_id_0323d78e_fk_accounts_', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='notifications_notification_pkey')
    )
    with op.batch_alter_table('notifications_notification', schema=None) as batch_op:
        batch_op.create_index('notifications_notification_recipient_user_id_0323d78e', ['recipient_user_id'], unique=False)
        batch_op.create_index('notifications_notification_recipient_driver_id_088dcc20', ['recipient_driver_id'], unique=False)
        batch_op.create_index('notifications_notification_municipality_id_31b4dd52', ['municipality_id'], unique=False)

    op.create_table('forms_formoption',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('label', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('value', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('order', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('question_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('"order" >= 0', name='forms_formoption_order_check'),
    sa.ForeignKeyConstraint(['question_id'], ['forms_formquestion.id'], name='forms_formoption_question_id_e3597f36_fk_forms_formquestion_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='forms_formoption_pkey')
    )
    with op.batch_alter_table('forms_formoption', schema=None) as batch_op:
        batch_op.create_index('forms_formoption_question_id_e3597f36', ['question_id'], unique=False)

    op.create_table('drivers_driver',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('cpf', sa.VARCHAR(length=14), autoincrement=False, nullable=False),
    sa.Column('cnh_number', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('cnh_category', sa.VARCHAR(length=5), autoincrement=False, nullable=False),
    sa.Column('cnh_expiration_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('phone', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('access_code', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('free_trip_enabled', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('photo', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='drivers_driver_municipality_id_3065c6d4_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='drivers_driver_pkey'),
    sa.UniqueConstraint('access_code', name='drivers_driver_access_code_key'),
    sa.UniqueConstraint('municipality_id', 'cpf', name='drivers_driver_municipality_id_cpf_636abc1b_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('drivers_driver', schema=None) as batch_op:
        batch_op.create_index('drivers_driver_municipality_id_3065c6d4', ['municipality_id'], unique=False)
        batch_op.create_index('drivers_driver_access_code_7a45c17a_like', ['access_code'], unique=False)

    op.create_table('forms_formsubmission',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('cpf', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('protocol_number', sa.VARCHAR(length=64), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('status_notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('form_template_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('linked_student_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('linked_student_card_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('linked_trip_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['form_template_id'], ['forms_formtemplate.id'], name='forms_formsubmission_form_template_id_0c99c680_fk_forms_for', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['linked_student_card_id'], ['students_studentcard.id'], name='forms_formsubmission_linked_student_card__474580b0_fk_students_', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['linked_student_id'], ['students_student.id'], name='forms_formsubmission_linked_student_id_76ff7cb7_fk_students_', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['linked_trip_id'], ['trips_trip.id'], name='forms_formsubmission_linked_trip_id_a934f985_fk_trips_trip_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='forms_formsubmission_municipality_id_b2e47e99_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='forms_formsubmission_pkey'),
    sa.UniqueConstraint('protocol_number', name='forms_formsubmission_protocol_number_key'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('forms_formsubmission', schema=None) as batch_op:
        batch_op.create_index('forms_formsubmission_protocol_number_b9e1efb3_like', ['protocol_number'], unique=False)
        batch_op.create_index('forms_formsubmission_municipality_id_b2e47e99', ['municipality_id'], unique=False)
        batch_op.create_index('forms_formsubmission_linked_trip_id_a934f985', ['linked_trip_id'], unique=False)
        batch_op.create_index('forms_formsubmission_linked_student_id_76ff7cb7', ['linked_student_id'], unique=False)
        batch_op.create_index('forms_formsubmission_linked_student_card_id_474580b0', ['linked_student_card_id'], unique=False)
        batch_op.create_index('forms_formsubmission_form_template_id_0c99c680', ['form_template_id'], unique=False)
        batch_op.create_index('forms_formsubmission_cpf_0d02008e_like', ['cpf'], unique=False)
        batch_op.create_index('forms_formsubmission_cpf_0d02008e', ['cpf'], unique=False)

    op.create_table('fleet_fuelproduct',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('unit', sa.VARCHAR(length=10), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_fuelproduct_municipality_id_e6c41409_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_fuelproduct_pkey'),
    sa.UniqueConstraint('municipality_id', 'name', name='fleet_fuelproduct_municipality_id_name_6fe8252b_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('fleet_fuelproduct', schema=None) as batch_op:
        batch_op.create_index('fleet_fuelproduct_municipality_id_e6c41409', ['municipality_id'], unique=False)

    op.create_table('api_booking_services',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('booking_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('service_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['booking_id'], ['api_booking.id'], name='api_booking_services_booking_id_c24b0228_fk_api_booking_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['service_id'], ['api_service.id'], name='api_booking_services_service_id_0a3379d9_fk_api_service_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='api_booking_services_pkey'),
    sa.UniqueConstraint('booking_id', 'service_id', name='api_booking_services_booking_id_service_id_99c88cb9_uniq')
    )
    with op.batch_alter_table('api_booking_services', schema=None) as batch_op:
        batch_op.create_index('api_booking_services_service_id_0a3379d9', ['service_id'], unique=False)
        batch_op.create_index('api_booking_services_booking_id_c24b0228', ['booking_id'], unique=False)

    op.create_table('contracts_rentalperiod',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('start_datetime', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('end_datetime', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('odometer_start', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('odometer_end', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('billed_km', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=True),
    sa.Column('billed_amount', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('contract_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.CheckConstraint('odometer_end >= 0', name='contracts_rentalperiod_odometer_end_check'),
    sa.CheckConstraint('odometer_start >= 0', name='contracts_rentalperiod_odometer_start_check'),
    sa.ForeignKeyConstraint(['contract_id'], ['contracts_contract.id'], name='contracts_rentalperi_contract_id_bae27a50_fk_contracts', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='contracts_rentalperi_municipality_id_f3e7b793_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='contracts_rentalperiod_vehicle_id_90e53068_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='contracts_rentalperiod_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('contracts_rentalperiod', schema=None) as batch_op:
        batch_op.create_index('contracts_rentalperiod_vehicle_id_90e53068', ['vehicle_id'], unique=False)
        batch_op.create_index('contracts_rentalperiod_municipality_id_f3e7b793', ['municipality_id'], unique=False)
        batch_op.create_index('contracts_rentalperiod_contract_id_bae27a50', ['contract_id'], unique=False)

    op.create_table('api_barbershop',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('rating', sa.DOUBLE_PRECISION(precision=53), autoincrement=False, nullable=False),
    sa.Column('reviews_count', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('image', sa.VARCHAR(length=1000), autoincrement=False, nullable=False),
    sa.Column('logo', sa.VARCHAR(length=1000), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('opening_hours', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('phone', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('tags', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('main_service_price', sa.NUMERIC(precision=6, scale=2), autoincrement=False, nullable=False),
    sa.Column('main_service_name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name='api_barbershop_pkey'),
    postgresql_ignore_search_path=False
    )
    op.create_table('drivers_drivergeofence',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('center_lat', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=False),
    sa.Column('center_lng', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=False),
    sa.Column('radius_m', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('is_active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('alert_active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('last_alerted_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('cleared_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('radius_m >= 0', name='drivers_drivergeofence_radius_m_check'),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='drivers_drivergeofence_driver_id_a5f18339_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='drivers_drivergeofence_pkey'),
    sa.UniqueConstraint('driver_id', name='drivers_drivergeofence_driver_id_key')
    )
    op.create_table('api_booking',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('time', sa.VARCHAR(length=10), autoincrement=False, nullable=False),
    sa.Column('payment_method', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('barber_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('shop_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['barber_id'], ['api_barber.id'], name='api_booking_barber_id_926556d3_fk_api_barber_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['shop_id'], ['api_barbershop.id'], name='api_booking_shop_id_deb36517_fk_api_barbershop_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['user_id'], ['api_user.id'], name='api_booking_user_id_0beb30da_fk_api_user_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='api_booking_pkey')
    )
    with op.batch_alter_table('api_booking', schema=None) as batch_op:
        batch_op.create_index('api_booking_user_id_0beb30da', ['user_id'], unique=False)
        batch_op.create_index('api_booking_shop_id_deb36517', ['shop_id'], unique=False)
        batch_op.create_index('api_booking_barber_id_926556d3', ['barber_id'], unique=False)

    op.create_table('fleet_vehicleinspectiondamagephoto',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('image', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('inspection_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['inspection_id'], ['fleet_vehicleinspection.id'], name='fleet_vehicleinspect_inspection_id_5686bfbd_fk_fleet_veh', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_vehicleinspectiondamagephoto_pkey')
    )
    with op.batch_alter_table('fleet_vehicleinspectiondamagephoto', schema=None) as batch_op:
        batch_op.create_index('fleet_vehicleinspectiondamagephoto_inspection_id_5686bfbd', ['inspection_id'], unique=False)

    op.create_table('students_studenttransportregistration',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('pickup_address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('pickup_district', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('dropoff_address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('dropoff_district', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('shift', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('days_of_week', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('route_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('valid_from', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('valid_until', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('allowed_contract_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('school_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('student_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['allowed_contract_id'], ['contracts_contract.id'], name='students_studenttran_allowed_contract_id_c82671eb_fk_contracts', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='students_studenttran_municipality_id_8a654005_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['school_id'], ['students_school.id'], name='students_studenttran_school_id_5530c39a_fk_students_', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['student_id'], ['students_student.id'], name='students_studenttran_student_id_fb549e97_fk_students_', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='students_studenttransportregistration_pkey')
    )
    with op.batch_alter_table('students_studenttransportregistration', schema=None) as batch_op:
        batch_op.create_index('students_studenttransportregistration_student_id_fb549e97', ['student_id'], unique=False)
        batch_op.create_index('students_studenttransportregistration_school_id_5530c39a', ['school_id'], unique=False)
        batch_op.create_index('students_studenttransportregistration_municipality_id_8a654005', ['municipality_id'], unique=False)
        batch_op.create_index('students_studenttransportr_allowed_contract_id_c82671eb', ['allowed_contract_id'], unique=False)

    op.create_table('transport_planning_serviceapplication',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('status', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('status_notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('correction_deadline', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('form_submission_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('person_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('route_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('transport_service_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['form_submission_id'], ['forms_formsubmission.id'], name='transport_planning_s_form_submission_id_711d1aa2_fk_forms_for', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_s_municipality_id_be2b317d_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['person_id'], ['transport_planning_person.id'], name='transport_planning_s_person_id_50d73a3f_fk_transport', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['route_id'], ['transport_planning_route.id'], name='transport_planning_s_route_id_74fb2489_fk_transport', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['transport_service_id'], ['transport_planning_transportservice.id'], name='transport_planning_s_transport_service_id_d72d389f_fk_transport', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_serviceapplication_pkey')
    )
    with op.batch_alter_table('transport_planning_serviceapplication', schema=None) as batch_op:
        batch_op.create_index('transport_planning_serviceapplication_route_id_74fb2489', ['route_id'], unique=False)
        batch_op.create_index('transport_planning_serviceapplication_person_id_50d73a3f', ['person_id'], unique=False)
        batch_op.create_index('transport_planning_serviceapplication_municipality_id_be2b317d', ['municipality_id'], unique=False)
        batch_op.create_index('transport_planning_service_transport_service_id_d72d389f', ['transport_service_id'], unique=False)
        batch_op.create_index('transport_planning_service_form_submission_id_711d1aa2', ['form_submission_id'], unique=False)

    op.create_table('api_review',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('rating', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('comment', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('shop_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['shop_id'], ['api_barbershop.id'], name='api_review_shop_id_5b5f7c0d_fk_api_barbershop_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['user_id'], ['api_user.id'], name='api_review_user_id_8bf97ad4_fk_api_user_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='api_review_pkey')
    )
    with op.batch_alter_table('api_review', schema=None) as batch_op:
        batch_op.create_index('api_review_user_id_8bf97ad4', ['user_id'], unique=False)
        batch_op.create_index('api_review_shop_id_5b5f7c0d', ['shop_id'], unique=False)

    op.create_table('students_studentcard',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('card_number', sa.VARCHAR(length=64), autoincrement=False, nullable=False),
    sa.Column('type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('issue_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('expiration_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('qr_payload', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('printed', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('student_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='students_studentcard_municipality_id_fb3ec95b_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['student_id'], ['students_student.id'], name='students_studentcard_student_id_c403dba2_fk_students_student_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='students_studentcard_pkey'),
    sa.UniqueConstraint('municipality_id', 'card_number', name='students_studentcard_municipality_id_card_number_f4250cff_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('students_studentcard', schema=None) as batch_op:
        batch_op.create_index('unique_active_card_per_student_type', ['student_id', 'type'], unique=True, postgresql_where="((status)::text = 'ACTIVE'::text)")
        batch_op.create_index('students_studentcard_student_id_c403dba2', ['student_id'], unique=False)
        batch_op.create_index('students_studentcard_municipality_id_fb3ec95b', ['municipality_id'], unique=False)

    op.create_table('token_blacklist_blacklistedtoken',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('blacklisted_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('token_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['token_id'], ['token_blacklist_outstandingtoken.id'], name='token_blacklist_blacklistedtoken_token_id_3cc7fe56_fk', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='token_blacklist_blacklistedtoken_pkey'),
    sa.UniqueConstraint('token_id', name='token_blacklist_blacklistedtoken_token_id_key')
    )
    op.create_table('accounts_user_user_permissions',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('permission_id', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['permission_id'], ['auth_permission.id'], name='accounts_user_user_p_permission_id_113bb443_fk_auth_perm', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['user_id'], ['accounts_user.id'], name='accounts_user_user_p_user_id_e4f0a161_fk_accounts_', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='accounts_user_user_permissions_pkey'),
    sa.UniqueConstraint('user_id', 'permission_id', name='accounts_user_user_permi_user_id_permission_id_2ab516c2_uniq')
    )
    with op.batch_alter_table('accounts_user_user_permissions', schema=None) as batch_op:
        batch_op.create_index('accounts_user_user_permissions_user_id_e4f0a161', ['user_id'], unique=False)
        batch_op.create_index('accounts_user_user_permissions_permission_id_113bb443', ['permission_id'], unique=False)

    op.create_table('api_user_groups',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('group_id', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['group_id'], ['auth_group.id'], name='api_user_groups_group_id_3af85785_fk_auth_group_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['user_id'], ['api_user.id'], name='api_user_groups_user_id_a5ff39fa_fk_api_user_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='api_user_groups_pkey'),
    sa.UniqueConstraint('user_id', 'group_id', name='api_user_groups_user_id_group_id_9c7ddfb5_uniq')
    )
    with op.batch_alter_table('api_user_groups', schema=None) as batch_op:
        batch_op.create_index('api_user_groups_user_id_a5ff39fa', ['user_id'], unique=False)
        batch_op.create_index('api_user_groups_group_id_3af85785', ['group_id'], unique=False)

    op.create_table('health_companion',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('full_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('cpf', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('date_of_birth', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('relationship', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('phone', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('patient_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='health_companion_municipality_id_cb2f7eb4_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['patient_id'], ['health_patient.id'], name='health_companion_patient_id_4e85a514_fk_health_patient_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='health_companion_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('health_companion', schema=None) as batch_op:
        batch_op.create_index('health_companion_patient_id_4e85a514', ['patient_id'], unique=False)
        batch_op.create_index('health_companion_municipality_id_cb2f7eb4', ['municipality_id'], unique=False)

    op.create_table('fleet_fuelstation',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('cnpj', sa.VARCHAR(length=18), autoincrement=False, nullable=False),
    sa.Column('address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_fuelstation_municipality_id_22248af7_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_fuelstation_pkey'),
    sa.UniqueConstraint('municipality_id', 'name', name='fleet_fuelstation_municipality_id_name_7ebfff03_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('fleet_fuelstation', schema=None) as batch_op:
        batch_op.create_index('fleet_fuelstation_municipality_id_22248af7', ['municipality_id'], unique=False)

    op.create_table('fleet_vehiclemaintenance',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('mileage', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('mileage >= 0', name='fleet_vehiclemaintenance_mileage_check'),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='fleet_vehiclemainten_vehicle_id_dfc8c124_fk_fleet_veh', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_vehiclemaintenance_pkey')
    )
    with op.batch_alter_table('fleet_vehiclemaintenance', schema=None) as batch_op:
        batch_op.create_index('fleet_vehiclemaintenance_vehicle_id_dfc8c124', ['vehicle_id'], unique=False)

    op.create_table('scheduling_driveravailabilityblock',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('type', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('start_datetime', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('end_datetime', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('all_day', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('reason', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('attachment', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('created_by_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['created_by_id'], ['accounts_user.id'], name='scheduling_driverava_created_by_id_a96742f7_fk_accounts_', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='scheduling_driverava_driver_id_7be7f625_fk_drivers_d', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='scheduling_driverava_municipality_id_3d1360fa_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='scheduling_driveravailabilityblock_pkey')
    )
    with op.batch_alter_table('scheduling_driveravailabilityblock', schema=None) as batch_op:
        batch_op.create_index('scheduling_driveravailabilityblock_municipality_id_3d1360fa', ['municipality_id'], unique=False)
        batch_op.create_index('scheduling_driveravailabilityblock_driver_id_7be7f625', ['driver_id'], unique=False)
        batch_op.create_index('scheduling_driveravailabilityblock_created_by_id_a96742f7', ['created_by_id'], unique=False)

    op.create_table('accounts_user_groups',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('group_id', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['group_id'], ['auth_group.id'], name='accounts_user_groups_group_id_bd11a704_fk_auth_group_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['user_id'], ['accounts_user.id'], name='accounts_user_groups_user_id_52b62117_fk_accounts_user_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='accounts_user_groups_pkey'),
    sa.UniqueConstraint('user_id', 'group_id', name='accounts_user_groups_user_id_group_id_59c0b32f_uniq')
    )
    with op.batch_alter_table('accounts_user_groups', schema=None) as batch_op:
        batch_op.create_index('accounts_user_groups_user_id_52b62117', ['user_id'], unique=False)
        batch_op.create_index('accounts_user_groups_group_id_bd11a704', ['group_id'], unique=False)

    op.create_table('fleet_fuelalert',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('alert_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('severity', sa.VARCHAR(length=10), autoincrement=False, nullable=False),
    sa.Column('message', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('reference_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('reference_id', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('resolved_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('fuel_log_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('service_order_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('trip_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.CheckConstraint('reference_id >= 0', name='fleet_fuelalert_reference_id_check'),
    sa.ForeignKeyConstraint(['fuel_log_id'], ['fleet_fuellog.id'], name='fleet_fuelalert_fuel_log_id_e9ef30f0_fk_fleet_fuellog_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_fuelalert_municipality_id_fdabf918_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['service_order_id'], ['trips_serviceorder.id'], name='fleet_fuelalert_service_order_id_d6c7ff79_fk_trips_ser', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['trip_id'], ['trips_trip.id'], name='fleet_fuelalert_trip_id_c4971bbd_fk_trips_trip_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_fuelalert_pkey')
    )
    with op.batch_alter_table('fleet_fuelalert', schema=None) as batch_op:
        batch_op.create_index('fleet_fuelalert_trip_id_c4971bbd', ['trip_id'], unique=False)
        batch_op.create_index('fleet_fuelalert_service_order_id_d6c7ff79', ['service_order_id'], unique=False)
        batch_op.create_index('fleet_fuelalert_municipality_id_fdabf918', ['municipality_id'], unique=False)
        batch_op.create_index('fleet_fuelalert_fuel_log_id_e9ef30f0', ['fuel_log_id'], unique=False)

    op.create_table('fleet_fuelrule',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('scope', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('allowed_weekdays', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('allowed_start_time', postgresql.TIME(), autoincrement=False, nullable=True),
    sa.Column('allowed_end_time', postgresql.TIME(), autoincrement=False, nullable=True),
    sa.Column('min_interval_minutes', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('contract_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.CheckConstraint('min_interval_minutes >= 0', name='fleet_fuelrule_min_interval_minutes_check'),
    sa.ForeignKeyConstraint(['contract_id'], ['contracts_contract.id'], name='fleet_fuelrule_contract_id_d23fa8b1_fk_contracts_contract_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_fuelrule_municipality_id_e5445180_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='fleet_fuelrule_vehicle_id_a8fdec16_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_fuelrule_pkey')
    )
    with op.batch_alter_table('fleet_fuelrule', schema=None) as batch_op:
        batch_op.create_index('fleet_fuelrule_vehicle_id_a8fdec16', ['vehicle_id'], unique=False)
        batch_op.create_index('fleet_fuelrule_municipality_id_e5445180', ['municipality_id'], unique=False)
        batch_op.create_index('fleet_fuelrule_contract_id_d23fa8b1', ['contract_id'], unique=False)

    op.create_table('transport_planning_transportservice',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('service_type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('requires_authorization', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('form_template_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['form_template_id'], ['forms_formtemplate.id'], name='transport_planning_t_form_template_id_bef029c3_fk_forms_for', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_t_municipality_id_9b0cc15b_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_transportservice_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('transport_planning_transportservice', schema=None) as batch_op:
        batch_op.create_index('transport_planning_transportservice_municipality_id_9b0cc15b', ['municipality_id'], unique=False)
        batch_op.create_index('transport_planning_transportservice_form_template_id_bef029c3', ['form_template_id'], unique=False)

    op.create_table('token_blacklist_outstandingtoken',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('token', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('expires_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('jti', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['user_id'], ['accounts_user.id'], name='token_blacklist_outs_user_id_83bc629a_fk_accounts_', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='token_blacklist_outstandingtoken_pkey'),
    sa.UniqueConstraint('jti', name='token_blacklist_outstandingtoken_jti_hex_d9bdf6f7_uniq')
    )
    with op.batch_alter_table('token_blacklist_outstandingtoken', schema=None) as batch_op:
        batch_op.create_index('token_blacklist_outstandingtoken_user_id_83bc629a', ['user_id'], unique=False)
        batch_op.create_index('token_blacklist_outstandingtoken_jti_hex_d9bdf6f7_like', ['jti'], unique=False)

    op.create_table('trips_tripgpsping',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('lat', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=False),
    sa.Column('lng', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=False),
    sa.Column('accuracy', sa.DOUBLE_PRECISION(precision=53), autoincrement=False, nullable=True),
    sa.Column('speed', sa.DOUBLE_PRECISION(precision=53), autoincrement=False, nullable=True),
    sa.Column('recorded_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('trip_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='trips_tripgpsping_driver_id_a070f02f_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['trip_id'], ['trips_trip.id'], name='trips_tripgpsping_trip_id_8c66e2f2_fk_trips_trip_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_tripgpsping_pkey')
    )
    with op.batch_alter_table('trips_tripgpsping', schema=None) as batch_op:
        batch_op.create_index('trips_tripgpsping_trip_id_8c66e2f2', ['trip_id'], unique=False)
        batch_op.create_index('trips_tripgpsping_driver_id_a070f02f', ['driver_id'], unique=False)
        batch_op.create_index('trips_tripg_trip_id_86e071_idx', ['trip_id', 'recorded_at'], unique=False)
        batch_op.create_index('trips_tripg_driver__b455e8_idx', ['driver_id', 'recorded_at'], unique=False)

    op.create_table('contracts_contract',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('contract_number', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('provider_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('provider_cnpj', sa.VARCHAR(length=18), autoincrement=False, nullable=False),
    sa.Column('start_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('end_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('billing_model', sa.VARCHAR(length=30), autoincrement=False, nullable=False),
    sa.Column('base_value', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('included_km_per_month', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('extra_km_rate', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('included_km_per_month >= 0', name='contracts_contract_included_km_per_month_check'),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='contracts_contract_municipality_id_9b4d54f6_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='contracts_contract_pkey'),
    sa.UniqueConstraint('municipality_id', 'contract_number', name='contract_number_unique_per_municipality'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('contracts_contract', schema=None) as batch_op:
        batch_op.create_index('contracts_contract_municipality_id_9b4d54f6', ['municipality_id'], unique=False)

    op.create_table('students_school',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('inep_code', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('city', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('district', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('phone', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('is_active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('destination_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['destination_id'], ['destinations_destination.id'], name='students_school_destination_id_28ccc2c8_fk_destinati', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='students_school_municipality_id_4ad0e800_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='students_school_pkey'),
    sa.UniqueConstraint('municipality_id', 'name', name='students_school_municipality_id_name_3a22394e_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('students_school', schema=None) as batch_op:
        batch_op.create_index('students_school_municipality_id_4ad0e800', ['municipality_id'], unique=False)
        batch_op.create_index('students_school_destination_id_28ccc2c8', ['destination_id'], unique=False)

    op.create_table('trips_plannedtrippassenger',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('passenger_type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('companion_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('patient_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('planned_trip_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('student_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['companion_id'], ['health_companion.id'], name='trips_plannedtrippas_companion_id_71ebcc5e_fk_health_co', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['patient_id'], ['health_patient.id'], name='trips_plannedtrippas_patient_id_caecc0a3_fk_health_pa', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['planned_trip_id'], ['trips_plannedtrip.id'], name='trips_plannedtrippas_planned_trip_id_0697e9fb_fk_trips_pla', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['student_id'], ['students_student.id'], name='trips_plannedtrippas_student_id_2d900fe2_fk_students_', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_plannedtrippassenger_pkey')
    )
    with op.batch_alter_table('trips_plannedtrippassenger', schema=None) as batch_op:
        batch_op.create_index('trips_plannedtrippassenger_student_id_2d900fe2', ['student_id'], unique=False)
        batch_op.create_index('trips_plannedtrippassenger_planned_trip_id_0697e9fb', ['planned_trip_id'], unique=False)
        batch_op.create_index('trips_plannedtrippassenger_patient_id_caecc0a3', ['patient_id'], unique=False)
        batch_op.create_index('trips_plannedtrippassenger_companion_id_71ebcc5e', ['companion_id'], unique=False)

    op.create_table('transport_planning_route_preferred_drivers',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('route_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='transport_planning_r_driver_id_e5894036_fk_drivers_d', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['route_id'], ['transport_planning_route.id'], name='transport_planning_r_route_id_f1039491_fk_transport', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_route_preferred_drivers_pkey'),
    sa.UniqueConstraint('route_id', 'driver_id', name='transport_planning_route_route_id_driver_id_68bc6f46_uniq')
    )
    with op.batch_alter_table('transport_planning_route_preferred_drivers', schema=None) as batch_op:
        batch_op.create_index('transport_planning_route_preferred_drivers_route_id_f1039491', ['route_id'], unique=False)
        batch_op.create_index('transport_planning_route_preferred_drivers_driver_id_e5894036', ['driver_id'], unique=False)

    op.create_table('api_user_user_permissions',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('permission_id', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['permission_id'], ['auth_permission.id'], name='api_user_user_permis_permission_id_305b7fea_fk_auth_perm', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['user_id'], ['api_user.id'], name='api_user_user_permissions_user_id_f3945d65_fk_api_user_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='api_user_user_permissions_pkey'),
    sa.UniqueConstraint('user_id', 'permission_id', name='api_user_user_permissions_user_id_permission_id_a06dd704_uniq')
    )
    with op.batch_alter_table('api_user_user_permissions', schema=None) as batch_op:
        batch_op.create_index('api_user_user_permissions_user_id_f3945d65', ['user_id'], unique=False)
        batch_op.create_index('api_user_user_permissions_permission_id_305b7fea', ['permission_id'], unique=False)

    op.create_table('trips_tripmanifestpassenger',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('passenger_type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('companion_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('linked_patient_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('manifest_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('patient_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('student_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['companion_id'], ['health_companion.id'], name='trips_tripmanifestpa_companion_id_b032bdf6_fk_health_co', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['linked_patient_id'], ['health_patient.id'], name='trips_tripmanifestpa_linked_patient_id_b7cb9dbe_fk_health_pa', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['manifest_id'], ['trips_tripmanifest.id'], name='trips_tripmanifestpa_manifest_id_2d8dc761_fk_trips_tri', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['patient_id'], ['health_patient.id'], name='trips_tripmanifestpa_patient_id_d2f7f3a4_fk_health_pa', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['student_id'], ['students_student.id'], name='trips_tripmanifestpa_student_id_787ee508_fk_students_', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_tripmanifestpassenger_pkey')
    )
    with op.batch_alter_table('trips_tripmanifestpassenger', schema=None) as batch_op:
        batch_op.create_index('trips_tripmanifestpassenger_student_id_787ee508', ['student_id'], unique=False)
        batch_op.create_index('trips_tripmanifestpassenger_patient_id_d2f7f3a4', ['patient_id'], unique=False)
        batch_op.create_index('trips_tripmanifestpassenger_manifest_id_2d8dc761', ['manifest_id'], unique=False)
        batch_op.create_index('trips_tripmanifestpassenger_linked_patient_id_b7cb9dbe', ['linked_patient_id'], unique=False)
        batch_op.create_index('trips_tripmanifestpassenger_companion_id_b032bdf6', ['companion_id'], unique=False)

    op.create_table('trips_plannedtripstop',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('order', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('destination_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('planned_trip_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('"order" >= 0', name='trips_plannedtripstop_order_check'),
    sa.ForeignKeyConstraint(['destination_id'], ['destinations_destination.id'], name='trips_plannedtripsto_destination_id_0770bfee_fk_destinati', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['planned_trip_id'], ['trips_plannedtrip.id'], name='trips_plannedtripsto_planned_trip_id_ad17346d_fk_trips_pla', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_plannedtripstop_pkey'),
    sa.UniqueConstraint('planned_trip_id', 'order', name='trips_plannedtripstop_planned_trip_id_order_58885946_uniq')
    )
    with op.batch_alter_table('trips_plannedtripstop', schema=None) as batch_op:
        batch_op.create_index('trips_plannedtripstop_planned_trip_id_ad17346d', ['planned_trip_id'], unique=False)
        batch_op.create_index('trips_plannedtripstop_destination_id_0770bfee', ['destination_id'], unique=False)

    op.create_table('django_session',
    sa.Column('session_key', sa.VARCHAR(length=40), autoincrement=False, nullable=False),
    sa.Column('session_data', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('expire_date', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('session_key', name='django_session_pkey')
    )
    with op.batch_alter_table('django_session', schema=None) as batch_op:
        batch_op.create_index('django_session_session_key_c0390e0f_like', ['session_key'], unique=False)
        batch_op.create_index('django_session_expire_date_a5c62663', ['expire_date'], unique=False)

    op.create_table('django_admin_log',
    sa.Column('id', sa.INTEGER(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=2147483647, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('action_time', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('object_id', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('object_repr', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('action_flag', sa.SMALLINT(), autoincrement=False, nullable=False),
    sa.Column('change_message', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('content_type_id', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('action_flag >= 0', name='django_admin_log_action_flag_check'),
    sa.ForeignKeyConstraint(['content_type_id'], ['django_content_type.id'], name='django_admin_log_content_type_id_c4bce8eb_fk_django_co', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['user_id'], ['api_user.id'], name='django_admin_log_user_id_c564eba6_fk_api_user_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='django_admin_log_pkey')
    )
    with op.batch_alter_table('django_admin_log', schema=None) as batch_op:
        batch_op.create_index('django_admin_log_user_id_c564eba6', ['user_id'], unique=False)
        batch_op.create_index('django_admin_log_content_type_id_c4bce8eb', ['content_type_id'], unique=False)

    op.create_table('notifications_notificationdevice',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('device_type', sa.VARCHAR(length=12), autoincrement=False, nullable=False),
    sa.Column('token', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='notifications_notifi_driver_id_dbfde0d3_fk_drivers_d', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='notifications_notifi_municipality_id_28bc45c7_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['user_id'], ['accounts_user.id'], name='notifications_notifi_user_id_8200c980_fk_accounts_', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='notifications_notificationdevice_pkey'),
    sa.UniqueConstraint('token', 'device_type', name='notifications_notificati_token_device_type_7ebab333_uniq')
    )
    with op.batch_alter_table('notifications_notificationdevice', schema=None) as batch_op:
        batch_op.create_index('notifications_notificationdevice_user_id_8200c980', ['user_id'], unique=False)
        batch_op.create_index('notifications_notificationdevice_municipality_id_28bc45c7', ['municipality_id'], unique=False)
        batch_op.create_index('notifications_notificationdevice_driver_id_dbfde0d3', ['driver_id'], unique=False)

    op.create_table('auth_permission',
    sa.Column('id', sa.INTEGER(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=2147483647, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('content_type_id', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('codename', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['content_type_id'], ['django_content_type.id'], name='auth_permission_content_type_id_2f476e4b_fk_django_co', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='auth_permission_pkey'),
    sa.UniqueConstraint('content_type_id', 'codename', name='auth_permission_content_type_id_codename_01ab375a_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('auth_permission', schema=None) as batch_op:
        batch_op.create_index('auth_permission_content_type_id_2f476e4b', ['content_type_id'], unique=False)

    op.create_table('transport_planning_serviceunit',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('unit_type', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('lat', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=True),
    sa.Column('lng', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=True),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_s_municipality_id_1cf87409_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_serviceunit_pkey'),
    sa.UniqueConstraint('municipality_id', 'name', name='transport_planning_servi_municipality_id_name_6cdb4f2b_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('transport_planning_serviceunit', schema=None) as batch_op:
        batch_op.create_index('transport_planning_serviceunit_municipality_id_1cf87409', ['municipality_id'], unique=False)

    op.create_table('maintenance_tire',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('code', sa.VARCHAR(length=64), autoincrement=False, nullable=False),
    sa.Column('brand', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('model', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('size', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('purchase_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('purchase_price', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('total_km', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('km_since_last_retread', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('max_km_life', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('retread_count', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('km_since_last_retread >= 0', name='maintenance_tire_km_since_last_retread_check'),
    sa.CheckConstraint('max_km_life >= 0', name='maintenance_tire_max_km_life_check'),
    sa.CheckConstraint('retread_count >= 0', name='maintenance_tire_retread_count_check'),
    sa.CheckConstraint('total_km >= 0', name='maintenance_tire_total_km_check'),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='maintenance_tire_municipality_id_2e74023e_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='maintenance_tire_pkey'),
    sa.UniqueConstraint('municipality_id', 'code', name='maintenance_tire_municipality_id_code_834514f7_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('maintenance_tire', schema=None) as batch_op:
        batch_op.create_index('maintenance_tire_municipality_id_2e74023e', ['municipality_id'], unique=False)

    op.create_table('django_content_type',
    sa.Column('id', sa.INTEGER(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=2147483647, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('app_label', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('model', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name='django_content_type_pkey'),
    sa.UniqueConstraint('app_label', 'model', name='django_content_type_app_label_model_76bd3d3b_uniq'),
    postgresql_ignore_search_path=False
    )
    op.create_table('fleet_vehicleinspection',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('inspection_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('inspected_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('odometer', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('checklist_items', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('condition_status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('signature_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('signature_image', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('odometer >= 0', name='fleet_vehicleinspection_odometer_check'),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='fleet_vehicleinspection_driver_id_6f9c4ac4_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_vehicleinspect_municipality_id_96c94757_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='fleet_vehicleinspection_vehicle_id_10f7131c_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_vehicleinspection_pkey'),
    sa.UniqueConstraint('vehicle_id', 'inspection_date', name='unique_vehicle_inspection_per_day')
    )
    with op.batch_alter_table('fleet_vehicleinspection', schema=None) as batch_op:
        batch_op.create_index('fleet_vehicleinspection_vehicle_id_10f7131c', ['vehicle_id'], unique=False)
        batch_op.create_index('fleet_vehicleinspection_municipality_id_96c94757', ['municipality_id'], unique=False)
        batch_op.create_index('fleet_vehicleinspection_driver_id_6f9c4ac4', ['driver_id'], unique=False)

    op.create_table('fleet_fuellog',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('filled_at', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('liters', sa.NUMERIC(precision=8, scale=2), autoincrement=False, nullable=False),
    sa.Column('fuel_station', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('receipt_image', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('fuel_station_ref_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('price_per_liter', sa.NUMERIC(precision=8, scale=2), autoincrement=False, nullable=True),
    sa.Column('total_cost', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=True),
    sa.Column('odometer', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('product_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('quantity', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=True),
    sa.Column('service_order_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('ticket_number', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('ticket_value', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=True),
    sa.Column('trip_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.CheckConstraint('odometer >= 0', name='fleet_fuellog_odometer_check'),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='fleet_fuellog_driver_id_2f64594a_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['fuel_station_ref_id'], ['fleet_fuelstation.id'], name='fleet_fuellog_fuel_station_ref_id_eb6b5d5c_fk_fleet_fue', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_fuellog_municipality_id_8160a726_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['product_id'], ['fleet_fuelproduct.id'], name='fleet_fuellog_product_id_e0b968dd_fk_fleet_fuelproduct_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['service_order_id'], ['trips_serviceorder.id'], name='fleet_fuellog_service_order_id_95110efa_fk_trips_ser', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['trip_id'], ['trips_trip.id'], name='fleet_fuellog_trip_id_9c044440_fk_trips_trip_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='fleet_fuellog_vehicle_id_84aa6c18_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_fuellog_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('fleet_fuellog', schema=None) as batch_op:
        batch_op.create_index('fleet_fuellog_vehicle_id_84aa6c18', ['vehicle_id'], unique=False)
        batch_op.create_index('fleet_fuellog_trip_id_9c044440', ['trip_id'], unique=False)
        batch_op.create_index('fleet_fuellog_service_order_id_95110efa', ['service_order_id'], unique=False)
        batch_op.create_index('fleet_fuellog_product_id_e0b968dd', ['product_id'], unique=False)
        batch_op.create_index('fleet_fuellog_municipality_id_8160a726', ['municipality_id'], unique=False)
        batch_op.create_index('fleet_fuellog_fuel_station_ref_id_eb6b5d5c', ['fuel_station_ref_id'], unique=False)
        batch_op.create_index('fleet_fuellog_driver_id_2f64594a', ['driver_id'], unique=False)

    op.create_table('trips_tripexecutionstop',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('order', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('arrival_time', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('departure_time', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('destination_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('trip_execution_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('"order" >= 0', name='trips_tripexecutionstop_order_check'),
    sa.ForeignKeyConstraint(['destination_id'], ['destinations_destination.id'], name='trips_tripexecutions_destination_id_dea7dbfd_fk_destinati', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['trip_execution_id'], ['trips_tripexecution.id'], name='trips_tripexecutions_trip_execution_id_0d944283_fk_trips_tri', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_tripexecutionstop_pkey'),
    sa.UniqueConstraint('trip_execution_id', 'order', name='trips_tripexecutionstop_trip_execution_id_order_e79716d9_uniq')
    )
    with op.batch_alter_table('trips_tripexecutionstop', schema=None) as batch_op:
        batch_op.create_index('trips_tripexecutionstop_trip_execution_id_0d944283', ['trip_execution_id'], unique=False)
        batch_op.create_index('trips_tripexecutionstop_destination_id_dea7dbfd', ['destination_id'], unique=False)

    op.create_table('contracts_contractvehicle',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('start_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('end_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('custom_billing_model', sa.VARCHAR(length=30), autoincrement=False, nullable=True),
    sa.Column('custom_rate', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('contract_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['contract_id'], ['contracts_contract.id'], name='contracts_contractve_contract_id_3d0b0062_fk_contracts', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='contracts_contractve_municipality_id_7db91e2a_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='contracts_contractve_vehicle_id_5f48200c_fk_fleet_veh', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='contracts_contractvehicle_pkey')
    )
    with op.batch_alter_table('contracts_contractvehicle', schema=None) as batch_op:
        batch_op.create_index('contracts_contractvehicle_vehicle_id_5f48200c', ['vehicle_id'], unique=False)
        batch_op.create_index('contracts_contractvehicle_municipality_id_7db91e2a', ['municipality_id'], unique=False)
        batch_op.create_index('contracts_contractvehicle_contract_id_3d0b0062', ['contract_id'], unique=False)

    op.create_table('trips_tripexecution',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('module', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('scheduled_departure', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('scheduled_return', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('actual_departure', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('actual_return', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('planned_capacity', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('is_manual_override', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('route_distance_km', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('route_duration_minutes', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('route_geometry', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('planned_trip_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('planned_capacity >= 0', name='trips_tripexecution_planned_capacity_check'),
    sa.CheckConstraint('route_duration_minutes >= 0', name='trips_tripexecution_route_duration_minutes_check'),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='trips_tripexecution_driver_id_cee5bec4_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='trips_tripexecution_municipality_id_93baa027_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['planned_trip_id'], ['trips_plannedtrip.id'], name='trips_tripexecution_planned_trip_id_66111665_fk_trips_pla', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='trips_tripexecution_vehicle_id_82054628_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_tripexecution_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('trips_tripexecution', schema=None) as batch_op:
        batch_op.create_index('trips_tripexecution_vehicle_id_82054628', ['vehicle_id'], unique=False)
        batch_op.create_index('trips_tripexecution_planned_trip_id_66111665', ['planned_trip_id'], unique=False)
        batch_op.create_index('trips_tripexecution_municipality_id_93baa027', ['municipality_id'], unique=False)
        batch_op.create_index('trips_tripexecution_driver_id_cee5bec4', ['driver_id'], unique=False)

    op.create_table('tenants_municipality',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('cnpj', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('city', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('state', sa.VARCHAR(length=2), autoincrement=False, nullable=False),
    sa.Column('phone', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('fuel_contract_limit', sa.NUMERIC(precision=14, scale=2), autoincrement=False, nullable=True),
    sa.Column('fuel_contract_period', sa.VARCHAR(length=12), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='tenants_municipality_pkey'),
    sa.UniqueConstraint('cnpj', name='tenants_municipality_cnpj_key'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('tenants_municipality', schema=None) as batch_op:
        batch_op.create_index('tenants_municipality_cnpj_c536bdef_like', ['cnpj'], unique=False)

    op.create_table('transport_planning_route',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('code', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('route_type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('days_of_week', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=False),
    sa.Column('time_window_start', postgresql.TIME(), autoincrement=False, nullable=True),
    sa.Column('time_window_end', postgresql.TIME(), autoincrement=False, nullable=True),
    sa.Column('estimated_duration_minutes', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('planned_capacity', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('contract_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('transport_service_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('estimated_duration_minutes >= 0', name='transport_planning_route_estimated_duration_minutes_check'),
    sa.CheckConstraint('planned_capacity >= 0', name='transport_planning_route_planned_capacity_check'),
    sa.ForeignKeyConstraint(['contract_id'], ['contracts_contract.id'], name='transport_planning_r_contract_id_80f7dc9a_fk_contracts', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_r_municipality_id_e4554fc1_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['transport_service_id'], ['transport_planning_transportservice.id'], name='transport_planning_r_transport_service_id_929bf154_fk_transport', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_route_pkey'),
    sa.UniqueConstraint('municipality_id', 'code', name='route_code_unique_per_municipality'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('transport_planning_route', schema=None) as batch_op:
        batch_op.create_index('transport_planning_route_transport_service_id_929bf154', ['transport_service_id'], unique=False)
        batch_op.create_index('transport_planning_route_municipality_id_e4554fc1', ['municipality_id'], unique=False)
        batch_op.create_index('transport_planning_route_contract_id_80f7dc9a', ['contract_id'], unique=False)

    op.create_table('auth_group',
    sa.Column('id', sa.INTEGER(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=2147483647, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=150), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name='auth_group_pkey'),
    sa.UniqueConstraint('name', name='auth_group_name_key'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('auth_group', schema=None) as batch_op:
        batch_op.create_index('auth_group_name_a6ea08ec_like', ['name'], unique=False)

    op.create_table('trips_monthlyodometer',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('year', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('month', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('kilometers', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('kilometers >= 0', name='trips_monthlyodometer_kilometers_check'),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='trips_monthlyodometer_vehicle_id_7455852d_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_monthlyodometer_pkey'),
    sa.UniqueConstraint('vehicle_id', 'year', 'month', name='trips_monthlyodometer_vehicle_id_year_month_2a7b01bc_uniq')
    )
    with op.batch_alter_table('trips_monthlyodometer', schema=None) as batch_op:
        batch_op.create_index('trips_monthlyodometer_vehicle_id_7455852d', ['vehicle_id'], unique=False)

    op.create_table('trips_freetripincident',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('free_trip_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='trips_freetripincident_driver_id_1e29f9ff_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['free_trip_id'], ['trips_freetrip.id'], name='trips_freetripincide_free_trip_id_8a3e6df6_fk_trips_fre', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='trips_freetripincide_municipality_id_b6b80ee7_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_freetripincident_pkey')
    )
    with op.batch_alter_table('trips_freetripincident', schema=None) as batch_op:
        batch_op.create_index('trips_freetripincident_municipality_id_b6b80ee7', ['municipality_id'], unique=False)
        batch_op.create_index('trips_freetripincident_free_trip_id_8a3e6df6', ['free_trip_id'], unique=False)
        batch_op.create_index('trips_freetripincident_driver_id_1e29f9ff', ['driver_id'], unique=False)

    op.create_table('api_barber',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('avatar', sa.VARCHAR(length=1000), autoincrement=False, nullable=False),
    sa.Column('shop_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['shop_id'], ['api_barbershop.id'], name='api_barber_shop_id_37fe6f86_fk_api_barbershop_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='api_barber_pkey')
    )
    with op.batch_alter_table('api_barber', schema=None) as batch_op:
        batch_op.create_index('api_barber_shop_id_37fe6f86', ['shop_id'], unique=False)

    op.create_table('transport_planning_assignment',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('generated_trip_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('route_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='transport_planning_a_driver_id_53056ad9_fk_drivers_d', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['generated_trip_id'], ['trips_trip.id'], name='transport_planning_a_generated_trip_id_8483c29b_fk_trips_tri', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_a_municipality_id_bea92ba0_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['route_id'], ['transport_planning_route.id'], name='transport_planning_a_route_id_e4d5a2fa_fk_transport', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='transport_planning_a_vehicle_id_f465ca71_fk_fleet_veh', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_assignment_pkey'),
    sa.UniqueConstraint('route_id', 'date', 'vehicle_id', 'driver_id', name='transport_planning_assig_route_id_date_vehicle_id_24e2ff5d_uniq')
    )
    with op.batch_alter_table('transport_planning_assignment', schema=None) as batch_op:
        batch_op.create_index('transport_planning_assignment_vehicle_id_f465ca71', ['vehicle_id'], unique=False)
        batch_op.create_index('transport_planning_assignment_route_id_e4d5a2fa', ['route_id'], unique=False)
        batch_op.create_index('transport_planning_assignment_municipality_id_bea92ba0', ['municipality_id'], unique=False)
        batch_op.create_index('transport_planning_assignment_generated_trip_id_8483c29b', ['generated_trip_id'], unique=False)
        batch_op.create_index('transport_planning_assignment_driver_id_53056ad9', ['driver_id'], unique=False)

    op.create_table('django_migrations',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('app', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('applied', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name='django_migrations_pkey')
    )
    op.create_table('students_classgroup',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=120), autoincrement=False, nullable=False),
    sa.Column('shift', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('school_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='students_classgroup_municipality_id_1d7dfa2c_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['school_id'], ['students_school.id'], name='students_classgroup_school_id_4add0ef4_fk_students_school_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='students_classgroup_pkey'),
    sa.UniqueConstraint('municipality_id', 'school_id', 'name', name='students_classgroup_municipality_id_school_i_037ae05b_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('students_classgroup', schema=None) as batch_op:
        batch_op.create_index('students_classgroup_school_id_4add0ef4', ['school_id'], unique=False)
        batch_op.create_index('students_classgroup_municipality_id_1d7dfa2c', ['municipality_id'], unique=False)

    op.create_table('auth_group_permissions',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('group_id', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('permission_id', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['group_id'], ['auth_group.id'], name='auth_group_permissions_group_id_b120cbf9_fk_auth_group_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['permission_id'], ['auth_permission.id'], name='auth_group_permissio_permission_id_84c5c92e_fk_auth_perm', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='auth_group_permissions_pkey'),
    sa.UniqueConstraint('group_id', 'permission_id', name='auth_group_permissions_group_id_permission_id_0cd325b0_uniq')
    )
    with op.batch_alter_table('auth_group_permissions', schema=None) as batch_op:
        batch_op.create_index('auth_group_permissions_permission_id_84c5c92e', ['permission_id'], unique=False)
        batch_op.create_index('auth_group_permissions_group_id_b120cbf9', ['group_id'], unique=False)

    op.create_table('transport_planning_routeunit',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('route_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('service_unit_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_r_municipality_id_067f5f58_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['route_id'], ['transport_planning_route.id'], name='transport_planning_r_route_id_5cf44840_fk_transport', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['service_unit_id'], ['transport_planning_serviceunit.id'], name='transport_planning_r_service_unit_id_ec34f217_fk_transport', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_routeunit_pkey'),
    sa.UniqueConstraint('route_id', 'service_unit_id', name='transport_planning_route_route_id_service_unit_id_3bbcde43_uniq')
    )
    with op.batch_alter_table('transport_planning_routeunit', schema=None) as batch_op:
        batch_op.create_index('transport_planning_routeunit_service_unit_id_ec34f217', ['service_unit_id'], unique=False)
        batch_op.create_index('transport_planning_routeunit_route_id_5cf44840', ['route_id'], unique=False)
        batch_op.create_index('transport_planning_routeunit_municipality_id_067f5f58', ['municipality_id'], unique=False)

    op.create_table('trips_tripmanifest',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('total_passengers', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('trip_execution_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('total_passengers >= 0', name='trips_tripmanifest_total_passengers_check'),
    sa.ForeignKeyConstraint(['trip_execution_id'], ['trips_tripexecution.id'], name='trips_tripmanifest_trip_execution_id_759e91de_fk_trips_tri', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_tripmanifest_pkey'),
    sa.UniqueConstraint('trip_execution_id', name='trips_tripmanifest_trip_execution_id_key')
    )
    op.create_table('forms_formanswer',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('value_text', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('value_json', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('file', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('question_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('submission_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('modified_by_staff', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('staff_value_text', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('staff_value_json', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['question_id'], ['forms_formquestion.id'], name='forms_formanswer_question_id_c9035190_fk_forms_formquestion_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['submission_id'], ['forms_formsubmission.id'], name='forms_formanswer_submission_id_8d21a865_fk_forms_for', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='forms_formanswer_pkey')
    )
    with op.batch_alter_table('forms_formanswer', schema=None) as batch_op:
        batch_op.create_index('forms_formanswer_submission_id_8d21a865', ['submission_id'], unique=False)
        batch_op.create_index('forms_formanswer_question_id_c9035190', ['question_id'], unique=False)

    op.create_table('trips_tripincident',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('trip_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='trips_tripincident_driver_id_6ede4a8e_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='trips_tripincident_municipality_id_424dd0f6_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['trip_id'], ['trips_trip.id'], name='trips_tripincident_trip_id_14a24711_fk_trips_trip_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_tripincident_pkey')
    )
    with op.batch_alter_table('trips_tripincident', schema=None) as batch_op:
        batch_op.create_index('trips_tripincident_trip_id_14a24711', ['trip_id'], unique=False)
        batch_op.create_index('trips_tripincident_municipality_id_424dd0f6', ['municipality_id'], unique=False)
        batch_op.create_index('trips_tripincident_driver_id_6ede4a8e', ['driver_id'], unique=False)

    op.create_table('fleet_fuelinvoice',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('period_start', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('period_end', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('total_value', sa.NUMERIC(precision=14, scale=2), autoincrement=False, nullable=True),
    sa.Column('uploaded_file', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('fuel_station_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['fuel_station_id'], ['fleet_fuelstation.id'], name='fleet_fuelinvoice_fuel_station_id_4f2cc524_fk_fleet_fue', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_fuelinvoice_municipality_id_f608ef63_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_fuelinvoice_pkey'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('fleet_fuelinvoice', schema=None) as batch_op:
        batch_op.create_index('fleet_fuelinvoice_municipality_id_f608ef63', ['municipality_id'], unique=False)
        batch_op.create_index('fleet_fuelinvoice_fuel_station_id_4f2cc524', ['fuel_station_id'], unique=False)

    op.create_table('transport_planning_routestop',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('order', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('description', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('lat', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=True),
    sa.Column('lng', sa.NUMERIC(precision=9, scale=6), autoincrement=False, nullable=True),
    sa.Column('scheduled_time', postgresql.TIME(), autoincrement=False, nullable=True),
    sa.Column('stop_type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('route_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('"order" >= 0', name='transport_planning_routestop_order_check'),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='transport_planning_r_municipality_id_d4581051_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['route_id'], ['transport_planning_route.id'], name='transport_planning_r_route_id_a459b002_fk_transport', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='transport_planning_routestop_pkey'),
    sa.UniqueConstraint('route_id', 'order', name='transport_planning_routestop_route_id_order_372dfce4_uniq')
    )
    with op.batch_alter_table('transport_planning_routestop', schema=None) as batch_op:
        batch_op.create_index('transport_planning_routestop_route_id_a459b002', ['route_id'], unique=False)
        batch_op.create_index('transport_planning_routestop_municipality_id_d4581051', ['municipality_id'], unique=False)

    op.create_table('scheduling_driverworkschedule',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('weekday', sa.SMALLINT(), autoincrement=False, nullable=False),
    sa.Column('start_time', postgresql.TIME(), autoincrement=False, nullable=False),
    sa.Column('end_time', postgresql.TIME(), autoincrement=False, nullable=False),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('weekday >= 0', name='scheduling_driverworkschedule_weekday_check'),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='scheduling_driverwor_driver_id_860d8228_fk_drivers_d', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='scheduling_driverwor_municipality_id_59f6c70b_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='scheduling_driverworkschedule_pkey'),
    sa.UniqueConstraint('driver_id', 'weekday', 'start_time', 'end_time', name='scheduling_driverworksch_driver_id_weekday_start__bb2b1113_uniq')
    )
    with op.batch_alter_table('scheduling_driverworkschedule', schema=None) as batch_op:
        batch_op.create_index('scheduling_driverworkschedule_municipality_id_59f6c70b', ['municipality_id'], unique=False)
        batch_op.create_index('scheduling_driverworkschedule_driver_id_860d8228', ['driver_id'], unique=False)

    op.create_table('fleet_vehicle',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('license_plate', sa.VARCHAR(length=10), autoincrement=False, nullable=False),
    sa.Column('model', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('brand', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('year', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('max_passengers', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('odometer_current', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('odometer_initial', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('odometer_monthly_limit', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('last_service_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('next_service_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('last_oil_change_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('next_oil_change_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('current_contract_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('ownership_type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('image', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('category', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.CheckConstraint('max_passengers >= 0', name='fleet_vehicle_max_passengers_check'),
    sa.CheckConstraint('odometer_current >= 0', name='fleet_vehicle_odometer_current_check'),
    sa.CheckConstraint('odometer_initial >= 0', name='fleet_vehicle_odometer_initial_check'),
    sa.CheckConstraint('odometer_monthly_limit >= 0', name='fleet_vehicle_odometer_monthly_limit_check'),
    sa.CheckConstraint('year >= 0', name='fleet_vehicle_year_check'),
    sa.ForeignKeyConstraint(['current_contract_id'], ['contracts_contract.id'], name='fleet_vehicle_current_contract_id_724e3c10_fk_contracts', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_vehicle_municipality_id_fad27508_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_vehicle_pkey'),
    sa.UniqueConstraint('municipality_id', 'license_plate', name='fleet_vehicle_municipality_id_license_plate_c8995d91_uniq'),
    postgresql_ignore_search_path=False
    )
    with op.batch_alter_table('fleet_vehicle', schema=None) as batch_op:
        batch_op.create_index('fleet_vehicle_municipality_id_fad27508', ['municipality_id'], unique=False)
        batch_op.create_index('fleet_vehicle_current_contract_id_724e3c10', ['current_contract_id'], unique=False)

    op.create_table('maintenance_inventorymovement',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('type', sa.VARCHAR(length=8), autoincrement=False, nullable=False),
    sa.Column('quantity', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('unit_cost', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('reference', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('performed_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('performed_by_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('part_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('responsible_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('expected_return_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='maintenance_inventor_municipality_id_1d02c3c5_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['part_id'], ['maintenance_inventorypart.id'], name='maintenance_inventor_part_id_bf6e09b8_fk_maintenan', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['performed_by_id'], ['accounts_user.id'], name='maintenance_inventor_performed_by_id_c99f8c9d_fk_accounts_', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='maintenance_inventorymovement_pkey')
    )
    with op.batch_alter_table('maintenance_inventorymovement', schema=None) as batch_op:
        batch_op.create_index('maintenance_inventorymovement_performed_by_id_c99f8c9d', ['performed_by_id'], unique=False)
        batch_op.create_index('maintenance_inventorymovement_part_id_bf6e09b8', ['part_id'], unique=False)
        batch_op.create_index('maintenance_inventorymovement_municipality_id_1d02c3c5', ['municipality_id'], unique=False)

    op.create_table('trips_freetrip',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('odometer_start', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('odometer_start_photo', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('odometer_end', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('odometer_end_photo', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('started_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('ended_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('driver_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('odometer_end >= 0', name='trips_freetrip_odometer_end_check'),
    sa.CheckConstraint('odometer_start >= 0', name='trips_freetrip_odometer_start_check'),
    sa.ForeignKeyConstraint(['driver_id'], ['drivers_driver.id'], name='trips_freetrip_driver_id_d9e77d1a_fk_drivers_driver_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='trips_freetrip_municipality_id_513d4a18_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='trips_freetrip_vehicle_id_97ede4f9_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='trips_freetrip_pkey')
    )
    with op.batch_alter_table('trips_freetrip', schema=None) as batch_op:
        batch_op.create_index('trips_freetrip_vehicle_id_97ede4f9', ['vehicle_id'], unique=False)
        batch_op.create_index('trips_freetrip_municipality_id_513d4a18', ['municipality_id'], unique=False)
        batch_op.create_index('trips_freetrip_driver_id_d9e77d1a', ['driver_id'], unique=False)

    op.create_table('maintenance_inventorypart',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('sku', sa.VARCHAR(length=64), autoincrement=False, nullable=False),
    sa.Column('unit', sa.VARCHAR(length=16), autoincrement=False, nullable=False),
    sa.Column('minimum_stock', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('current_stock', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('average_cost', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('is_active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='maintenance_inventor_municipality_id_a6922598_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='maintenance_inventorypart_pkey'),
    sa.UniqueConstraint('municipality_id', 'sku', name='maintenance_inventorypart_municipality_id_sku_e2fba9ea_uniq')
    )
    with op.batch_alter_table('maintenance_inventorypart', schema=None) as batch_op:
        batch_op.create_index('maintenance_inventorypart_municipality_id_a6922598', ['municipality_id'], unique=False)

    op.create_table('api_user',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('password', sa.VARCHAR(length=128), autoincrement=False, nullable=False),
    sa.Column('last_login', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('is_superuser', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('username', sa.VARCHAR(length=150), autoincrement=False, nullable=False),
    sa.Column('first_name', sa.VARCHAR(length=150), autoincrement=False, nullable=False),
    sa.Column('last_name', sa.VARCHAR(length=150), autoincrement=False, nullable=False),
    sa.Column('email', sa.VARCHAR(length=254), autoincrement=False, nullable=False),
    sa.Column('is_staff', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('is_active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('date_joined', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name='api_user_pkey'),
    sa.UniqueConstraint('username', name='api_user_username_key')
    )
    with op.batch_alter_table('api_user', schema=None) as batch_op:
        batch_op.create_index('api_user_username_cf4e88d2_like', ['username'], unique=False)

    op.create_table('students_student',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('full_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('social_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('date_of_birth', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('cpf', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('registration_number', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('grade', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('shift', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('address', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('district', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('has_special_needs', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('special_needs_details', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('school_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('class_group_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['class_group_id'], ['students_classgroup.id'], name='students_student_class_group_id_39273d50_fk_students_', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='students_student_municipality_id_cd84d4b2_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['school_id'], ['students_school.id'], name='students_student_school_id_be4a7ab9_fk_students_school_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='students_student_pkey')
    )
    with op.batch_alter_table('students_student', schema=None) as batch_op:
        batch_op.create_index('unique_active_student_cpf_per_municipality', ['municipality_id', 'cpf'], unique=True, postgresql_where="((status)::text = 'ACTIVE'::text)")
        batch_op.create_index('students_student_school_id_be4a7ab9', ['school_id'], unique=False)
        batch_op.create_index('students_student_municipality_id_cd84d4b2', ['municipality_id'], unique=False)
        batch_op.create_index('students_student_cpf_55107b60_like', ['cpf'], unique=False)
        batch_op.create_index('students_student_cpf_55107b60', ['cpf'], unique=False)
        batch_op.create_index('students_student_class_group_id_39273d50', ['class_group_id'], unique=False)

    op.create_table('fleet_fuelinvoiceitem',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('ticket_number', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('occurred_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('quantity', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('unit_price', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=True),
    sa.Column('total_value', sa.NUMERIC(precision=14, scale=2), autoincrement=False, nullable=True),
    sa.Column('invoice_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('matched_fuel_log_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('product_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['invoice_id'], ['fleet_fuelinvoice.id'], name='fleet_fuelinvoiceite_invoice_id_da5befd5_fk_fleet_fue', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['matched_fuel_log_id'], ['fleet_fuellog.id'], name='fleet_fuelinvoiceite_matched_fuel_log_id_13a61983_fk_fleet_fue', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['product_id'], ['fleet_fuelproduct.id'], name='fleet_fuelinvoiceite_product_id_6203feae_fk_fleet_fue', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_fuelinvoiceitem_pkey')
    )
    with op.batch_alter_table('fleet_fuelinvoiceitem', schema=None) as batch_op:
        batch_op.create_index('fleet_fuelinvoiceitem_product_id_6203feae', ['product_id'], unique=False)
        batch_op.create_index('fleet_fuelinvoiceitem_matched_fuel_log_id_13a61983', ['matched_fuel_log_id'], unique=False)
        batch_op.create_index('fleet_fuelinvoiceitem_invoice_id_da5befd5', ['invoice_id'], unique=False)

    op.create_table('fleet_fuelstationlimit',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('period', sa.VARCHAR(length=10), autoincrement=False, nullable=False),
    sa.Column('max_quantity', sa.NUMERIC(precision=12, scale=2), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('contract_id', sa.BIGINT(), autoincrement=False, nullable=True),
    sa.Column('fuel_station_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('municipality_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('product_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['contract_id'], ['contracts_contract.id'], name='fleet_fuelstationlim_contract_id_94727825_fk_contracts', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['fuel_station_id'], ['fleet_fuelstation.id'], name='fleet_fuelstationlim_fuel_station_id_639c2d0f_fk_fleet_fue', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['municipality_id'], ['tenants_municipality.id'], name='fleet_fuelstationlim_municipality_id_21b9fc07_fk_tenants_m', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['product_id'], ['fleet_fuelproduct.id'], name='fleet_fuelstationlim_product_id_8d69fa0a_fk_fleet_fue', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='fleet_fuelstationlimit_pkey'),
    sa.UniqueConstraint('fuel_station_id', 'contract_id', 'product_id', 'period', name='unique_station_limit_per_period')
    )
    with op.batch_alter_table('fleet_fuelstationlimit', schema=None) as batch_op:
        batch_op.create_index('fleet_fuelstationlimit_product_id_8d69fa0a', ['product_id'], unique=False)
        batch_op.create_index('fleet_fuelstationlimit_municipality_id_21b9fc07', ['municipality_id'], unique=False)
        batch_op.create_index('fleet_fuelstationlimit_fuel_station_id_639c2d0f', ['fuel_station_id'], unique=False)
        batch_op.create_index('fleet_fuelstationlimit_contract_id_94727825', ['contract_id'], unique=False)

    op.create_table('authtoken_token',
    sa.Column('key', sa.VARCHAR(length=40), autoincrement=False, nullable=False),
    sa.Column('created', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('user_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['user_id'], ['accounts_user.id'], name='authtoken_token_user_id_35299eff_fk_accounts_user_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('key', name='authtoken_token_pkey'),
    sa.UniqueConstraint('user_id', name='authtoken_token_user_id_key')
    )
    with op.batch_alter_table('authtoken_token', schema=None) as batch_op:
        batch_op.create_index('authtoken_token_key_10f0b77e_like', ['key'], unique=False)

    op.create_table('maintenance_vehicletire',
    sa.Column('id', sa.BIGINT(), sa.Identity(always=False, start=1, increment=1, minvalue=1, maxvalue=9223372036854775807, cycle=False, cache=1), autoincrement=True, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('position', sa.VARCHAR(length=32), autoincrement=False, nullable=False),
    sa.Column('installed_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=False),
    sa.Column('installed_odometer', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('removed_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('removed_odometer', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('active', sa.BOOLEAN(), autoincrement=False, nullable=False),
    sa.Column('tire_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.Column('vehicle_id', sa.BIGINT(), autoincrement=False, nullable=False),
    sa.CheckConstraint('installed_odometer >= 0', name='maintenance_vehicletire_installed_odometer_check'),
    sa.CheckConstraint('removed_odometer >= 0', name='maintenance_vehicletire_removed_odometer_check'),
    sa.ForeignKeyConstraint(['tire_id'], ['maintenance_tire.id'], name='maintenance_vehicletire_tire_id_45446a88_fk_maintenance_tire_id', initially='DEFERRED', deferrable=True),
    sa.ForeignKeyConstraint(['vehicle_id'], ['fleet_vehicle.id'], name='maintenance_vehicletire_vehicle_id_dcea6e7f_fk_fleet_vehicle_id', initially='DEFERRED', deferrable=True),
    sa.PrimaryKeyConstraint('id', name='maintenance_vehicletire_pkey')
    )
    with op.batch_alter_table('maintenance_vehicletire', schema=None) as batch_op:
        batch_op.create_index('unique_active_tire_position', ['vehicle_id', 'position'], unique=True, postgresql_where='active')
        batch_op.create_index('maintenance_vehicletire_vehicle_id_dcea6e7f', ['vehicle_id'], unique=False)
        batch_op.create_index('maintenance_vehicletire_tire_id_45446a88', ['tire_id'], unique=False)

    op.drop_table('feedback_aberto_respostas')
    op.drop_table('feedback_aberto_envios')
    op.drop_table('feedback_aberto_dia_perguntas')
    op.drop_table('feedback_aberto_perguntas')
    op.drop_table('feedback_aberto_dias')
    # ### end Alembic commands ###
